"""SQL fragment definitions for DataFusion view builders."""

FRAGMENT_SQL: dict[str, str] = {
    'ast_call_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM ast_calls',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.parent_ast_id AS parent_ast_id,',
        '      base.func_kind AS func_kind,',
        '      base.func_name AS func_name,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'ast_calls': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'ast_id') AS ast_id,",
        "      get_field(n0.n0_item, 'parent_ast_id') AS parent_ast_id,",
        "      get_field(n0.n0_item, 'func_kind') AS func_kind,",
        "      get_field(n0.n0_item, 'func_name') AS func_name,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.calls) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.parent_ast_id AS parent_ast_id,',
        '      base.func_kind AS func_kind,',
        '      base.func_name AS func_name,',
        "      arrow_cast(list_extract(map_extract(base.attrs, 'arg_count'), 1),",
        "'Int32') AS arg_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'keyword_count'), 1),",
        "'Int32') AS keyword_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'starred_count'), 1),",
        "'Int32') AS starred_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'kw_star_count'), 1),",
        "'Int32') AS kw_star_count,",
        "      arrow_cast((get_field(get_field(base.span, 'start'), 'line0') + 1),",
        "'Int64') AS lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'start'), 'col'), 'Int64')",
        'AS col_offset,',
        "      arrow_cast((get_field(get_field(base.span, 'end'), 'line0') + 1),",
        "'Int64') AS end_lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'end'), 'col'), 'Int64') AS",
        'end_col_offset,',
        "      arrow_cast(1, 'Int32') AS line_base,",
        "      arrow_cast(get_field(base.span, 'col_unit'), 'Utf8') AS col_unit,",
        "      arrow_cast(get_field(base.span, 'end_exclusive'), 'Boolean') AS",
        'end_exclusive,',
        "      named_struct('start', get_field(base.span, 'start'), 'end',",
        "get_field(base.span, 'end'), 'byte_span', get_field(base.span, 'byte_span'),",
        "'col_unit', get_field(base.span, 'col_unit'), 'end_exclusive',",
        "get_field(base.span, 'end_exclusive')) AS span,",
        '      base.attrs AS attrs,',
        "      named_struct('span', named_struct('start', get_field(base.span,",
        "'start'), 'end', get_field(base.span, 'end'), 'byte_span',",
        "get_field(base.span, 'byte_span'), 'col_unit', get_field(base.span,",
        "'col_unit'), 'end_exclusive', get_field(base.span, 'end_exclusive')),",
        "'attrs', base.attrs) AS ast_record",
        '    FROM base',
        "",
    ]),
    'ast_def_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM ast_defs',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.parent_ast_id AS parent_ast_id,',
        '      base.kind AS kind,',
        '      base.name AS name,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'ast_defs': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'ast_id') AS ast_id,",
        "      get_field(n0.n0_item, 'parent_ast_id') AS parent_ast_id,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.defs) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.parent_ast_id AS parent_ast_id,',
        '      base.kind AS kind,',
        '      base.name AS name,',
        "      arrow_cast(list_extract(map_extract(base.attrs, 'decorator_count'),",
        "1), 'Int32') AS decorator_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'arg_count'), 1),",
        "'Int32') AS arg_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'posonly_count'), 1),",
        "'Int32') AS posonly_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'kwonly_count'), 1),",
        "'Int32') AS kwonly_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'type_params_count'),",
        "1), 'Int32') AS type_params_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'base_count'), 1),",
        "'Int32') AS base_count,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'keyword_count'), 1),",
        "'Int32') AS keyword_count,",
        "      arrow_cast((get_field(get_field(base.span, 'start'), 'line0') + 1),",
        "'Int64') AS lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'start'), 'col'), 'Int64')",
        'AS col_offset,',
        "      arrow_cast((get_field(get_field(base.span, 'end'), 'line0') + 1),",
        "'Int64') AS end_lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'end'), 'col'), 'Int64') AS",
        'end_col_offset,',
        "      arrow_cast(1, 'Int32') AS line_base,",
        "      arrow_cast(get_field(base.span, 'col_unit'), 'Utf8') AS col_unit,",
        "      arrow_cast(get_field(base.span, 'end_exclusive'), 'Boolean') AS",
        'end_exclusive,',
        "      named_struct('start', get_field(base.span, 'start'), 'end',",
        "get_field(base.span, 'end'), 'byte_span', get_field(base.span, 'byte_span'),",
        "'col_unit', get_field(base.span, 'col_unit'), 'end_exclusive',",
        "get_field(base.span, 'end_exclusive')) AS span,",
        '      base.attrs AS attrs,',
        "      named_struct('span', named_struct('start', get_field(base.span,",
        "'start'), 'end', get_field(base.span, 'end'), 'byte_span',",
        "get_field(base.span, 'byte_span'), 'col_unit', get_field(base.span,",
        "'col_unit'), 'end_exclusive', get_field(base.span, 'end_exclusive')),",
        "'attrs', base.attrs) AS ast_record",
        '    FROM base',
        "",
    ]),
    'ast_docstrings': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'owner_ast_id') AS owner_ast_id,",
        "      get_field(n0.n0_item, 'owner_kind') AS owner_kind,",
        "      get_field(n0.n0_item, 'owner_name') AS owner_name,",
        "      get_field(n0.n0_item, 'docstring') AS docstring,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'source') AS source,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.docstrings) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.owner_ast_id AS owner_ast_id,',
        '      base.owner_kind AS owner_kind,',
        '      base.owner_name AS owner_name,',
        '      base.docstring AS docstring,',
        '      base.source AS source,',
        "      arrow_cast((get_field(get_field(base.span, 'start'), 'line0') + 1),",
        "'Int64') AS lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'start'), 'col'), 'Int64')",
        'AS col_offset,',
        "      arrow_cast((get_field(get_field(base.span, 'end'), 'line0') + 1),",
        "'Int64') AS end_lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'end'), 'col'), 'Int64') AS",
        'end_col_offset,',
        "      arrow_cast(1, 'Int32') AS line_base,",
        "      arrow_cast(get_field(base.span, 'col_unit'), 'Utf8') AS col_unit,",
        "      arrow_cast(get_field(base.span, 'end_exclusive'), 'Boolean') AS",
        'end_exclusive,',
        "      named_struct('start', get_field(base.span, 'start'), 'end',",
        "get_field(base.span, 'end'), 'byte_span', get_field(base.span, 'byte_span'),",
        "'col_unit', get_field(base.span, 'col_unit'), 'end_exclusive',",
        "get_field(base.span, 'end_exclusive')) AS span,",
        '      base.attrs AS attrs,',
        "      named_struct('span', named_struct('start', get_field(base.span,",
        "'start'), 'end', get_field(base.span, 'end'), 'byte_span',",
        "get_field(base.span, 'byte_span'), 'col_unit', get_field(base.span,",
        "'col_unit'), 'end_exclusive', get_field(base.span, 'end_exclusive')),",
        "'attrs', base.attrs) AS ast_record",
        '    FROM base',
        "",
    ]),
    'ast_edge_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM ast_edges',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.src AS src,',
        '      base.dst AS dst,',
        '      base.kind AS kind,',
        '      base.slot AS slot,',
        '      base.idx AS idx,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'ast_edges': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'src') AS src,",
        "      get_field(n0.n0_item, 'dst') AS dst,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'slot') AS slot,",
        "      get_field(n0.n0_item, 'idx') AS idx,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.edges) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.src AS src,',
        '      base.dst AS dst,',
        '      base.kind AS kind,',
        '      base.slot AS slot,',
        '      base.idx AS idx,',
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ast_errors': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'error_type') AS error_type,",
        "      get_field(n0.n0_item, 'message') AS message,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.errors) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.error_type AS error_type,',
        '      base.message AS message,',
        "      arrow_cast((get_field(get_field(base.span, 'start'), 'line0') + 1),",
        "'Int64') AS lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'start'), 'col'), 'Int64')",
        'AS col_offset,',
        "      arrow_cast((get_field(get_field(base.span, 'end'), 'line0') + 1),",
        "'Int64') AS end_lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'end'), 'col'), 'Int64') AS",
        'end_col_offset,',
        "      arrow_cast(1, 'Int32') AS line_base,",
        "      arrow_cast(get_field(base.span, 'col_unit'), 'Utf8') AS col_unit,",
        "      arrow_cast(get_field(base.span, 'end_exclusive'), 'Boolean') AS",
        'end_exclusive,',
        "      named_struct('start', get_field(base.span, 'start'), 'end',",
        "get_field(base.span, 'end'), 'byte_span', get_field(base.span, 'byte_span'),",
        "'col_unit', get_field(base.span, 'col_unit'), 'end_exclusive',",
        "get_field(base.span, 'end_exclusive')) AS span,",
        '      base.attrs AS attrs,',
        "      named_struct('span', named_struct('start', get_field(base.span,",
        "'start'), 'end', get_field(base.span, 'end'), 'byte_span',",
        "get_field(base.span, 'byte_span'), 'col_unit', get_field(base.span,",
        "'col_unit'), 'end_exclusive', get_field(base.span, 'end_exclusive')),",
        "'attrs', base.attrs) AS ast_record",
        '    FROM base',
        "",
    ]),
    'ast_imports': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'ast_id') AS ast_id,",
        "      get_field(n0.n0_item, 'parent_ast_id') AS parent_ast_id,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'module') AS module,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'asname') AS asname,",
        "      get_field(n0.n0_item, 'alias_index') AS alias_index,",
        "      get_field(n0.n0_item, 'level') AS level,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.imports) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.parent_ast_id AS parent_ast_id,',
        '      base.kind AS kind,',
        '      base.module AS module,',
        '      base.name AS name,',
        '      base.asname AS asname,',
        '      base.alias_index AS alias_index,',
        '      base.level AS level,',
        "      arrow_cast((get_field(get_field(base.span, 'start'), 'line0') + 1),",
        "'Int64') AS lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'start'), 'col'), 'Int64')",
        'AS col_offset,',
        "      arrow_cast((get_field(get_field(base.span, 'end'), 'line0') + 1),",
        "'Int64') AS end_lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'end'), 'col'), 'Int64') AS",
        'end_col_offset,',
        "      arrow_cast(1, 'Int32') AS line_base,",
        "      arrow_cast(get_field(base.span, 'col_unit'), 'Utf8') AS col_unit,",
        "      arrow_cast(get_field(base.span, 'end_exclusive'), 'Boolean') AS",
        'end_exclusive,',
        "      named_struct('start', get_field(base.span, 'start'), 'end',",
        "get_field(base.span, 'end'), 'byte_span', get_field(base.span, 'byte_span'),",
        "'col_unit', get_field(base.span, 'col_unit'), 'end_exclusive',",
        "get_field(base.span, 'end_exclusive')) AS span,",
        '      base.attrs AS attrs,',
        "      named_struct('span', named_struct('start', get_field(base.span,",
        "'start'), 'end', get_field(base.span, 'end'), 'byte_span',",
        "get_field(base.span, 'byte_span'), 'col_unit', get_field(base.span,",
        "'col_unit'), 'end_exclusive', get_field(base.span, 'end_exclusive')),",
        "'attrs', base.attrs) AS ast_record",
        '    FROM base',
        "",
    ]),
    'ast_node_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM ast_nodes',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.parent_ast_id AS parent_ast_id,',
        '      base.kind AS kind,',
        '      base.name AS name,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'ast_nodes': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'ast_id') AS ast_id,",
        "      get_field(n0.n0_item, 'parent_ast_id') AS parent_ast_id,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'value') AS value,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.nodes) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.parent_ast_id AS parent_ast_id,',
        '      base.kind AS kind,',
        '      base.name AS name,',
        '      base.value AS value_repr,',
        "      arrow_cast((get_field(get_field(base.span, 'start'), 'line0') + 1),",
        "'Int64') AS lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'start'), 'col'), 'Int64')",
        'AS col_offset,',
        "      arrow_cast((get_field(get_field(base.span, 'end'), 'line0') + 1),",
        "'Int64') AS end_lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'end'), 'col'), 'Int64') AS",
        'end_col_offset,',
        "      arrow_cast(1, 'Int32') AS line_base,",
        "      arrow_cast(get_field(base.span, 'col_unit'), 'Utf8') AS col_unit,",
        "      arrow_cast(get_field(base.span, 'end_exclusive'), 'Boolean') AS",
        'end_exclusive,',
        "      arrow_cast(get_field(get_field(base.span, 'byte_span'), 'byte_start'),",
        "'Int64') AS bstart,",
        "      arrow_cast((get_field(get_field(base.span, 'byte_span'), 'byte_start')",
        "+ get_field(get_field(base.span, 'byte_span'), 'byte_len')), 'Int64') AS",
        'bend,',
        "      named_struct('start', get_field(base.span, 'start'), 'end',",
        "get_field(base.span, 'end'), 'byte_span', get_field(base.span, 'byte_span'),",
        "'col_unit', get_field(base.span, 'col_unit'), 'end_exclusive',",
        "get_field(base.span, 'end_exclusive')) AS span,",
        '      base.attrs AS attrs,',
        "      named_struct('span', named_struct('start', get_field(base.span,",
        "'start'), 'end', get_field(base.span, 'end'), 'byte_span',",
        "get_field(base.span, 'byte_span'), 'col_unit', get_field(base.span,",
        "'col_unit'), 'end_exclusive', get_field(base.span, 'end_exclusive')),",
        "'attrs', base.attrs) AS ast_record",
        '    FROM base',
        "",
    ]),
    'ast_span_metadata': "\n".join([
        '    SELECT',
        "      arrow_metadata(nodes.span, 'line_base') AS nodes_line_base,",
        "      arrow_metadata(nodes.span, 'col_unit') AS nodes_col_unit,",
        "      arrow_metadata(nodes.span, 'end_exclusive') AS nodes_end_exclusive,",
        "      arrow_metadata(errors.span, 'line_base') AS errors_line_base,",
        "      arrow_metadata(errors.span, 'col_unit') AS errors_col_unit,",
        "      arrow_metadata(errors.span, 'end_exclusive') AS errors_end_exclusive,",
        "      arrow_metadata(docstrings.span, 'line_base') AS docstrings_line_base,",
        "      arrow_metadata(docstrings.span, 'col_unit') AS docstrings_col_unit,",
        "      arrow_metadata(docstrings.span, 'end_exclusive') AS",
        'docstrings_end_exclusive,',
        "      arrow_metadata(imports.span, 'line_base') AS imports_line_base,",
        "      arrow_metadata(imports.span, 'col_unit') AS imports_col_unit,",
        "      arrow_metadata(imports.span, 'end_exclusive') AS",
        'imports_end_exclusive,',
        "      arrow_metadata(defs.span, 'line_base') AS defs_line_base,",
        "      arrow_metadata(defs.span, 'col_unit') AS defs_col_unit,",
        "      arrow_metadata(defs.span, 'end_exclusive') AS defs_end_exclusive,",
        "      arrow_metadata(calls.span, 'line_base') AS calls_line_base,",
        "      arrow_metadata(calls.span, 'col_unit') AS calls_col_unit,",
        "      arrow_metadata(calls.span, 'end_exclusive') AS calls_end_exclusive,",
        "      arrow_metadata(type_ignores.span, 'line_base') AS",
        'type_ignores_line_base,',
        "      arrow_metadata(type_ignores.span, 'col_unit') AS",
        'type_ignores_col_unit,',
        "      arrow_metadata(type_ignores.span, 'end_exclusive') AS",
        'type_ignores_end_exclusive',
        '    FROM ast_files_v1',
        '    LIMIT 1',
        "",
    ]),
    'ast_type_ignores': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'ast_id') AS ast_id,",
        "      get_field(n0.n0_item, 'tag') AS tag,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM ast_files_v1 AS root',
        'CROSS JOIN unnest(root.type_ignores) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ast_id AS ast_id,',
        '      base.tag AS tag,',
        "      arrow_cast((get_field(get_field(base.span, 'start'), 'line0') + 1),",
        "'Int64') AS lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'start'), 'col'), 'Int64')",
        'AS col_offset,',
        "      arrow_cast((get_field(get_field(base.span, 'end'), 'line0') + 1),",
        "'Int64') AS end_lineno,",
        "      arrow_cast(get_field(get_field(base.span, 'end'), 'col'), 'Int64') AS",
        'end_col_offset,',
        "      arrow_cast(1, 'Int32') AS line_base,",
        "      arrow_cast(get_field(base.span, 'col_unit'), 'Utf8') AS col_unit,",
        "      arrow_cast(get_field(base.span, 'end_exclusive'), 'Boolean') AS",
        'end_exclusive,',
        "      named_struct('start', get_field(base.span, 'start'), 'end',",
        "get_field(base.span, 'end'), 'byte_span', get_field(base.span, 'byte_span'),",
        "'col_unit', get_field(base.span, 'col_unit'), 'end_exclusive',",
        "get_field(base.span, 'end_exclusive')) AS span,",
        '      base.attrs AS attrs,',
        "      named_struct('span', named_struct('start', get_field(base.span,",
        "'start'), 'end', get_field(base.span, 'end'), 'byte_span',",
        "get_field(base.span, 'byte_span'), 'col_unit', get_field(base.span,",
        "'col_unit'), 'end_exclusive', get_field(base.span, 'end_exclusive')),",
        "'attrs', base.attrs) AS ast_record",
        '    FROM base',
        "",
    ]),
    'bytecode_errors': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'error_type') AS error_type,",
        "      get_field(n0.n0_item, 'message') AS message,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.errors) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.error_type AS error_type,',
        '      base.message AS message,',
        "      list_extract(map_extract(base.attrs, 'error_stage'), 1) AS",
        'error_stage,',
        "      list_extract(map_extract(base.attrs, 'code_id'), 1) AS code_id",
        '    FROM base',
        "",
    ]),
    'bytecode_exception_table': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'exc_index') AS exc_index,",
        "      get_field(n1.n1_item, 'start_offset') AS start_offset,",
        "      get_field(n1.n1_item, 'end_offset') AS end_offset,",
        "      get_field(n1.n1_item, 'target_offset') AS target_offset,",
        "      get_field(n1.n1_item, 'depth') AS depth,",
        "      get_field(n1.n1_item, 'lasti') AS lasti,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'exception_table')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.exc_index AS exc_index,',
        '      base.start_offset AS start_offset,',
        '      base.end_offset AS end_offset,',
        '      base.target_offset AS target_offset,',
        '      base.depth AS depth,',
        '      base.lasti AS lasti,',
        "      prefixed_hash64('bc_exc', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.exc_index, base.start_offset, base.end_offset, base.target_offset)) AS',
        'exc_entry_id',
        '    FROM base',
        "",
    ]),
    'cst_call_args': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'call_id') AS call_id,",
        "      get_field(n0.n0_item, 'call_bstart') AS call_bstart,",
        "      get_field(n0.n0_item, 'call_bend') AS call_bend,",
        "      get_field(n0.n0_item, 'arg_index') AS arg_index,",
        "      get_field(n0.n0_item, 'keyword') AS keyword,",
        "      get_field(n0.n0_item, 'star') AS star,",
        "      get_field(n0.n0_item, 'arg_text') AS arg_text,",
        "      get_field(n0.n0_item, 'bstart') AS bstart,",
        "      get_field(n0.n0_item, 'bend') AS bend",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.call_args) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        "      stable_id('cst_call', concat_ws('\x1f', 'cst_call',",
        "coalesce(CAST(base.file_id AS STRING), 'None'),",
        "coalesce(CAST(base.call_bstart AS STRING), 'None'),",
        "coalesce(CAST(base.call_bend AS STRING), 'None'))) AS call_id,",
        '      base.call_bstart AS call_bstart,',
        '      base.call_bend AS call_bend,',
        '      base.arg_index AS arg_index,',
        '      base.keyword AS keyword,',
        '      base.star AS star,',
        '      base.arg_text AS arg_text,',
        '      base.bstart AS bstart,',
        '      base.bend AS bend',
        '    FROM base',
        "",
    ]),
    'cst_callsite_span_unnest': "\n".join([
        '    WITH base AS (',
        '      SELECT',
        '        base.*,',
        "        named_struct('bstart', base.call_bstart, 'bend', base.call_bend) AS",
        'span',
        '      FROM cst_callsites base',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.call_id AS call_id,',
        "      get_field(base.span, 'bstart') AS bstart,",
        "      get_field(base.span, 'bend') AS bend",
        '    FROM base',
        "",
    ]),
    'cst_callsite_spans': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM cst_callsites',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.call_id AS call_id,',
        '      base.call_bstart AS bstart,',
        '      base.call_bend AS bend,',
        "      named_struct('bstart', base.call_bstart, 'bend', base.call_bend) AS",
        'span',
        '    FROM base',
        "",
    ]),
    'cst_callsites': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'call_id') AS call_id,",
        "      get_field(n0.n0_item, 'call_bstart') AS call_bstart,",
        "      get_field(n0.n0_item, 'call_bend') AS call_bend,",
        "      get_field(n0.n0_item, 'callee_bstart') AS callee_bstart,",
        "      get_field(n0.n0_item, 'callee_bend') AS callee_bend,",
        "      get_field(n0.n0_item, 'callee_shape') AS callee_shape,",
        "      get_field(n0.n0_item, 'callee_text') AS callee_text,",
        "      get_field(n0.n0_item, 'arg_count') AS arg_count,",
        "      get_field(n0.n0_item, 'callee_dotted') AS callee_dotted,",
        "      get_field(n0.n0_item, 'callee_qnames') AS callee_qnames,",
        "      get_field(n0.n0_item, 'callee_fqns') AS callee_fqns,",
        "      get_field(n0.n0_item, 'inferred_type') AS inferred_type,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.callsites) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        "      stable_id('cst_call', concat_ws('\x1f', 'cst_call',",
        "coalesce(CAST(base.file_id AS STRING), 'None'),",
        "coalesce(CAST(base.call_bstart AS STRING), 'None'),",
        "coalesce(CAST(base.call_bend AS STRING), 'None'))) AS call_id,",
        '      base.call_bstart AS call_bstart,',
        '      base.call_bend AS call_bend,',
        '      base.callee_bstart AS callee_bstart,',
        '      base.callee_bend AS callee_bend,',
        '      base.callee_shape AS callee_shape,',
        '      base.callee_text AS callee_text,',
        '      base.arg_count AS arg_count,',
        '      base.callee_dotted AS callee_dotted,',
        '      base.callee_qnames AS callee_qnames,',
        '      base.callee_fqns AS callee_fqns,',
        '      base.inferred_type AS inferred_type,',
        '      base.attrs AS attrs,',
        "      prefixed_hash64('span', concat_ws(':', base.file_id, base.call_bstart,",
        'base.call_bend)) AS span_id',
        '    FROM base',
        "",
    ]),
    'cst_callsites_attr_origin': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_callsites',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.call_id AS call_id,',
        "      map_extract(base.attrs, 'origin') AS origin",
        '    FROM base',
        "",
    ]),
    'cst_callsites_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_callsites',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.call_id AS call_id,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'cst_decorators': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'owner_def_id') AS owner_def_id,",
        "      get_field(n0.n0_item, 'owner_kind') AS owner_kind,",
        "      get_field(n0.n0_item, 'owner_def_bstart') AS owner_def_bstart,",
        "      get_field(n0.n0_item, 'owner_def_bend') AS owner_def_bend,",
        "      get_field(n0.n0_item, 'decorator_text') AS decorator_text,",
        "      get_field(n0.n0_item, 'decorator_index') AS decorator_index,",
        "      get_field(n0.n0_item, 'bstart') AS bstart,",
        "      get_field(n0.n0_item, 'bend') AS bend",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.decorators) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        '      CASE',
        '        WHEN base.owner_def_bstart IS NULL OR base.owner_def_bend IS NULL',
        'THEN NULL',
        "        ELSE stable_id('cst_def', concat_ws('\x1f', 'cst_def',",
        "coalesce(CAST(base.file_id AS STRING), 'None'),",
        "coalesce(CAST(base.owner_kind AS STRING), 'None'),",
        "coalesce(CAST(base.owner_def_bstart AS STRING), 'None'),",
        "coalesce(CAST(base.owner_def_bend AS STRING), 'None')))",
        '      END AS owner_def_id,',
        '      base.owner_kind AS owner_kind,',
        '      base.owner_def_bstart AS owner_def_bstart,',
        '      base.owner_def_bend AS owner_def_bend,',
        '      base.decorator_text AS decorator_text,',
        '      base.decorator_index AS decorator_index,',
        '      base.bstart AS bstart,',
        '      base.bend AS bend',
        '    FROM base',
        "",
    ]),
    'cst_def_span_unnest': "\n".join([
        '    WITH base AS (',
        '      SELECT',
        '        base.*,',
        "        named_struct('bstart', base.def_bstart, 'bend', base.def_bend) AS",
        'span',
        '      FROM cst_defs base',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.def_id AS def_id,',
        "      get_field(base.span, 'bstart') AS bstart,",
        "      get_field(base.span, 'bend') AS bend",
        '    FROM base',
        "",
    ]),
    'cst_def_spans': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM cst_defs',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.def_id AS def_id,',
        '      base.def_bstart AS bstart,',
        '      base.def_bend AS bend,',
        "      named_struct('bstart', base.def_bstart, 'bend', base.def_bend) AS span",
        '    FROM base',
        "",
    ]),
    'cst_defs': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'def_id') AS def_id,",
        "      get_field(n0.n0_item, 'container_def_kind') AS container_def_kind,",
        "      get_field(n0.n0_item, 'container_def_bstart') AS container_def_bstart,",
        "      get_field(n0.n0_item, 'container_def_bend') AS container_def_bend,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'def_bstart') AS def_bstart,",
        "      get_field(n0.n0_item, 'def_bend') AS def_bend,",
        "      get_field(n0.n0_item, 'name_bstart') AS name_bstart,",
        "      get_field(n0.n0_item, 'name_bend') AS name_bend,",
        "      get_field(n0.n0_item, 'qnames') AS qnames,",
        "      get_field(n0.n0_item, 'def_fqns') AS def_fqns,",
        "      get_field(n0.n0_item, 'docstring') AS docstring,",
        "      get_field(n0.n0_item, 'decorator_count') AS decorator_count,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.defs) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        "      stable_id('cst_def', concat_ws('\x1f', 'cst_def',",
        "coalesce(CAST(base.file_id AS STRING), 'None'), coalesce(CAST(base.kind AS",
        "STRING), 'None'), coalesce(CAST(base.def_bstart AS STRING), 'None'),",
        "coalesce(CAST(base.def_bend AS STRING), 'None'))) AS def_id,",
        '      base.container_def_kind AS container_def_kind,',
        '      base.container_def_bstart AS container_def_bstart,',
        '      base.container_def_bend AS container_def_bend,',
        '      base.kind AS kind,',
        '      base.name AS name,',
        '      base.def_bstart AS def_bstart,',
        '      base.def_bend AS def_bend,',
        '      base.name_bstart AS name_bstart,',
        '      base.name_bend AS name_bend,',
        '      base.qnames AS qnames,',
        '      base.def_fqns AS def_fqns,',
        '      base.docstring AS docstring,',
        '      base.decorator_count AS decorator_count,',
        '      base.attrs AS attrs,',
        '      CASE',
        '        WHEN base.container_def_kind IS NULL THEN NULL',
        "        ELSE stable_id('cst_def', concat_ws('\x1f', 'cst_def',",
        "coalesce(CAST(base.file_id AS STRING), 'None'),",
        "coalesce(CAST(base.container_def_kind AS STRING), 'None'),",
        "coalesce(CAST(base.container_def_bstart AS STRING), 'None'),",
        "coalesce(CAST(base.container_def_bend AS STRING), 'None')))",
        '      END AS container_def_id,',
        "      prefixed_hash64('span', concat_ws(':', base.file_id, base.def_bstart,",
        'base.def_bend)) AS span_id',
        '    FROM base',
        "",
    ]),
    'cst_defs_attr_origin': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_defs',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.def_id AS def_id,',
        "      map_extract(base.attrs, 'origin') AS origin",
        '    FROM base',
        "",
    ]),
    'cst_defs_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_defs',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.def_id AS def_id,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'cst_docstrings': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'owner_def_id') AS owner_def_id,",
        "      get_field(n0.n0_item, 'owner_kind') AS owner_kind,",
        "      get_field(n0.n0_item, 'owner_def_bstart') AS owner_def_bstart,",
        "      get_field(n0.n0_item, 'owner_def_bend') AS owner_def_bend,",
        "      get_field(n0.n0_item, 'docstring') AS docstring,",
        "      get_field(n0.n0_item, 'bstart') AS bstart,",
        "      get_field(n0.n0_item, 'bend') AS bend",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.docstrings) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        '      CASE',
        '        WHEN base.owner_def_bstart IS NULL OR base.owner_def_bend IS NULL',
        'THEN NULL',
        "        ELSE stable_id('cst_def', concat_ws('\x1f', 'cst_def',",
        "coalesce(CAST(base.file_id AS STRING), 'None'),",
        "coalesce(CAST(base.owner_kind AS STRING), 'None'),",
        "coalesce(CAST(base.owner_def_bstart AS STRING), 'None'),",
        "coalesce(CAST(base.owner_def_bend AS STRING), 'None')))",
        '      END AS owner_def_id,',
        '      base.owner_kind AS owner_kind,',
        '      base.owner_def_bstart AS owner_def_bstart,',
        '      base.owner_def_bend AS owner_def_bend,',
        '      base.docstring AS docstring,',
        '      base.bstart AS bstart,',
        '      base.bend AS bend',
        '    FROM base',
        "",
    ]),
    'cst_edges_attr_origin': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_edges',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.src AS src,',
        '      base.dst AS dst,',
        '      base.kind AS kind,',
        '      base.slot AS slot,',
        '      base.idx AS idx,',
        "      map_extract(base.attrs, 'origin') AS origin",
        '    FROM base',
        "",
    ]),
    'cst_edges_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_edges',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.src AS src,',
        '      base.dst AS dst,',
        '      base.kind AS kind,',
        '      base.slot AS slot,',
        '      base.idx AS idx,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'cst_imports': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'module') AS module,",
        "      get_field(n0.n0_item, 'relative_level') AS relative_level,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'asname') AS asname,",
        "      get_field(n0.n0_item, 'is_star') AS is_star,",
        "      get_field(n0.n0_item, 'stmt_bstart') AS stmt_bstart,",
        "      get_field(n0.n0_item, 'stmt_bend') AS stmt_bend,",
        "      get_field(n0.n0_item, 'alias_bstart') AS alias_bstart,",
        "      get_field(n0.n0_item, 'alias_bend') AS alias_bend,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.imports) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        '      base.kind AS kind,',
        '      base.module AS module,',
        '      base.relative_level AS relative_level,',
        '      base.name AS name,',
        '      base.asname AS asname,',
        '      base.is_star AS is_star,',
        '      base.stmt_bstart AS stmt_bstart,',
        '      base.stmt_bend AS stmt_bend,',
        '      base.alias_bstart AS alias_bstart,',
        '      base.alias_bend AS alias_bend,',
        '      base.attrs AS attrs,',
        "      prefixed_hash64('cst_import', concat_ws(':', base.file_id, base.kind,",
        'base.alias_bstart, base.alias_bend)) AS import_id,',
        "      prefixed_hash64('span', concat_ws(':', base.file_id,",
        'base.alias_bstart, base.alias_bend)) AS span_id',
        '    FROM base',
        "",
    ]),
    'cst_imports_attr_origin': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_imports',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.import_id AS import_id,',
        "      map_extract(base.attrs, 'origin') AS origin",
        '    FROM base',
        "",
    ]),
    'cst_imports_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_imports',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.import_id AS import_id,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'cst_nodes_attr_origin': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_nodes',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.cst_id AS cst_id,',
        "      map_extract(base.attrs, 'origin') AS origin",
        '    FROM base',
        "",
    ]),
    'cst_nodes_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_nodes',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.cst_id AS cst_id,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'cst_parse_errors': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'error_type') AS error_type,",
        "      get_field(n0.n0_item, 'message') AS message,",
        "      get_field(n0.n0_item, 'raw_line') AS raw_line,",
        "      get_field(n0.n0_item, 'raw_column') AS raw_column,",
        "      get_field(n0.n0_item, 'editor_line') AS editor_line,",
        "      get_field(n0.n0_item, 'editor_column') AS editor_column,",
        "      get_field(n0.n0_item, 'context') AS context,",
        "      get_field(n0.n0_item, 'line_base') AS line_base,",
        "      get_field(n0.n0_item, 'col_unit') AS col_unit,",
        "      get_field(n0.n0_item, 'end_exclusive') AS end_exclusive,",
        "      get_field(n0.n0_item, 'meta') AS meta",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.parse_errors) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        '      base.error_type AS error_type,',
        '      base.message AS message,',
        '      base.raw_line AS raw_line,',
        '      base.raw_column AS raw_column,',
        '      base.editor_line AS editor_line,',
        '      base.editor_column AS editor_column,',
        '      base.context AS context,',
        '      base.line_base AS line_base,',
        '      base.col_unit AS col_unit,',
        '      base.end_exclusive AS end_exclusive',
        '    FROM base',
        "",
    ]),
    'cst_parse_manifest': "\n".join([
        'SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'encoding') AS encoding,",
        "      get_field(n0.n0_item, 'default_indent') AS default_indent,",
        "      get_field(n0.n0_item, 'default_newline') AS default_newline,",
        "      get_field(n0.n0_item, 'has_trailing_newline') AS has_trailing_newline,",
        "      get_field(n0.n0_item, 'future_imports') AS future_imports,",
        "      get_field(n0.n0_item, 'module_name') AS module_name,",
        "      get_field(n0.n0_item, 'package_name') AS package_name,",
        "      get_field(n0.n0_item, 'libcst_version') AS libcst_version,",
        "      get_field(n0.n0_item, 'parser_backend') AS parser_backend,",
        "      get_field(n0.n0_item, 'parsed_python_version') AS",
        'parsed_python_version,',
        "      get_field(n0.n0_item, 'schema_fingerprint') AS schema_fingerprint",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.parse_manifest) AS n0(n0_item)',
    ]),
    'cst_ref_span_unnest': "\n".join([
        '    WITH base AS (',
        '      SELECT',
        '        base.*,',
        "        named_struct('bstart', base.bstart, 'bend', base.bend) AS span",
        '      FROM cst_refs base',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ref_id AS ref_id,',
        "      get_field(base.span, 'bstart') AS bstart,",
        "      get_field(base.span, 'bend') AS bend",
        '    FROM base',
        "",
    ]),
    'cst_ref_spans': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM cst_refs',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ref_id AS ref_id,',
        '      base.bstart AS bstart,',
        '      base.bend AS bend,',
        "      named_struct('bstart', base.bstart, 'bend', base.bend) AS span",
        '    FROM base',
        "",
    ]),
    'cst_refs': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'ref_id') AS ref_id,",
        "      get_field(n0.n0_item, 'ref_kind') AS ref_kind,",
        "      get_field(n0.n0_item, 'ref_text') AS ref_text,",
        "      get_field(n0.n0_item, 'expr_ctx') AS expr_ctx,",
        "      get_field(n0.n0_item, 'scope_type') AS scope_type,",
        "      get_field(n0.n0_item, 'scope_name') AS scope_name,",
        "      get_field(n0.n0_item, 'scope_role') AS scope_role,",
        "      get_field(n0.n0_item, 'parent_kind') AS parent_kind,",
        "      get_field(n0.n0_item, 'inferred_type') AS inferred_type,",
        "      get_field(n0.n0_item, 'bstart') AS bstart,",
        "      get_field(n0.n0_item, 'bend') AS bend,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.refs) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        "      stable_id('cst_ref', concat_ws('\x1f', 'cst_ref',",
        "coalesce(CAST(base.file_id AS STRING), 'None'), coalesce(CAST(base.bstart AS",
        "STRING), 'None'), coalesce(CAST(base.bend AS STRING), 'None'))) AS ref_id,",
        '      base.ref_kind AS ref_kind,',
        '      base.ref_text AS ref_text,',
        '      base.expr_ctx AS expr_ctx,',
        '      base.scope_type AS scope_type,',
        '      base.scope_name AS scope_name,',
        '      base.scope_role AS scope_role,',
        '      base.parent_kind AS parent_kind,',
        '      base.inferred_type AS inferred_type,',
        '      base.bstart AS bstart,',
        '      base.bend AS bend,',
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'cst_refs_attr_origin': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_refs',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ref_id AS ref_id,',
        "      map_extract(base.attrs, 'origin') AS origin",
        '    FROM base',
        "",
    ]),
    'cst_refs_attrs': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM cst_refs',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.ref_id AS ref_id,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'cst_schema_diagnostics': "\n".join([
        '    WITH base AS (',
        '      SELECT *',
        '      FROM libcst_files_v1',
        '      LIMIT 1',
        '    )',
        '    SELECT',
        '      arrow_typeof(base.nodes) AS nodes_type,',
        "      arrow_typeof(arrow_cast(base.nodes, 'list<item: struct<cst_id: int64",
        'not null, kind: string, span:',
        'extension<codeintel.span<_SemanticExtensionType>>, span_ws:',
        'extension<codeintel.span<_SemanticExtensionType>>, attrs: map<string,',
        "string>>>')) AS nodes_cast_type,",
        '      arrow_metadata(base.nodes) AS nodes_meta,',
        "      arrow_metadata(arrow_cast(base.nodes, 'list<item: struct<cst_id: int64",
        'not null, kind: string, span:',
        'extension<codeintel.span<_SemanticExtensionType>>, span_ws:',
        'extension<codeintel.span<_SemanticExtensionType>>, attrs: map<string,',
        "string>>>')) AS nodes_cast_meta,",
        '      arrow_typeof(base.edges) AS edges_type,',
        "      arrow_typeof(arrow_cast(base.edges, 'list<item: struct<src: int64 not",
        'null, dst: int64 not null, kind: string, slot: string, idx: int32, attrs:',
        "map<string, string>>>')) AS edges_cast_type,",
        '      arrow_metadata(base.edges) AS edges_meta,',
        "      arrow_metadata(arrow_cast(base.edges, 'list<item: struct<src: int64",
        'not null, dst: int64 not null, kind: string, slot: string, idx: int32,',
        "attrs: map<string, string>>>')) AS edges_cast_meta,",
        '      arrow_typeof(base.parse_manifest) AS parse_manifest_type,',
        "      arrow_typeof(arrow_cast(base.parse_manifest, 'list<item:",
        'struct<file_id: string not null, path: string not null, file_sha256: string,',
        'encoding: string, default_indent: string, default_newline: string,',
        'has_trailing_newline: bool, future_imports: list<item: string>, module_name:',
        'string, package_name: string, libcst_version: string, parser_backend:',
        "string, parsed_python_version: string, schema_fingerprint: string>>')) AS",
        'parse_manifest_cast_type,',
        '      arrow_metadata(base.parse_manifest) AS parse_manifest_meta,',
        "      arrow_metadata(arrow_cast(base.parse_manifest, 'list<item:",
        'struct<file_id: string not null, path: string not null, file_sha256: string,',
        'encoding: string, default_indent: string, default_newline: string,',
        'has_trailing_newline: bool, future_imports: list<item: string>, module_name:',
        'string, package_name: string, libcst_version: string, parser_backend:',
        "string, parsed_python_version: string, schema_fingerprint: string>>')) AS",
        'parse_manifest_cast_meta,',
        '      arrow_typeof(base.parse_errors) AS parse_errors_type,',
        "      arrow_typeof(arrow_cast(base.parse_errors, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, error_type:',
        'string, message: string, raw_line: int64, raw_column: int64, editor_line:',
        'int64, editor_column: int64, context: string, line_base: int32, col_unit:',
        "string, end_exclusive: bool, meta: map<string, string>>>')) AS",
        'parse_errors_cast_type,',
        '      arrow_metadata(base.parse_errors) AS parse_errors_meta,',
        "      arrow_metadata(arrow_cast(base.parse_errors, 'list<item:",
        'struct<file_id: string not null, path: string not null, file_sha256: string,',
        'error_type: string, message: string, raw_line: int64, raw_column: int64,',
        'editor_line: int64, editor_column: int64, context: string, line_base: int32,',
        "col_unit: string, end_exclusive: bool, meta: map<string, string>>>')) AS",
        'parse_errors_cast_meta,',
        '      arrow_typeof(base.refs) AS refs_type,',
        "      arrow_typeof(arrow_cast(base.refs, 'list<item: struct<file_id: string",
        'not null, path: string not null, file_sha256: string, ref_id: string,',
        'ref_kind: string, ref_text: string, expr_ctx: string, scope_type: string,',
        'scope_name: string, scope_role: string, parent_kind: string, inferred_type:',
        "string, bstart: int64, bend: int64, attrs: map<string, string>>>')) AS",
        'refs_cast_type,',
        '      arrow_metadata(base.refs) AS refs_meta,',
        "      arrow_metadata(arrow_cast(base.refs, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, ref_id: string,',
        'ref_kind: string, ref_text: string, expr_ctx: string, scope_type: string,',
        'scope_name: string, scope_role: string, parent_kind: string, inferred_type:',
        "string, bstart: int64, bend: int64, attrs: map<string, string>>>')) AS",
        'refs_cast_meta,',
        '      arrow_typeof(base.imports) AS imports_type,',
        "      arrow_typeof(arrow_cast(base.imports, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, kind: string,',
        'module: string, relative_level: int32, name: string, asname: string,',
        'is_star: bool, stmt_bstart: int64, stmt_bend: int64, alias_bstart: int64,',
        "alias_bend: int64, attrs: map<string, string>>>')) AS imports_cast_type,",
        '      arrow_metadata(base.imports) AS imports_meta,',
        "      arrow_metadata(arrow_cast(base.imports, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, kind: string,',
        'module: string, relative_level: int32, name: string, asname: string,',
        'is_star: bool, stmt_bstart: int64, stmt_bend: int64, alias_bstart: int64,',
        "alias_bend: int64, attrs: map<string, string>>>')) AS imports_cast_meta,",
        '      arrow_typeof(base.callsites) AS callsites_type,',
        "      arrow_typeof(arrow_cast(base.callsites, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, call_id:',
        'string, call_bstart: int64, call_bend: int64, callee_bstart: int64,',
        'callee_bend: int64, callee_shape: string, callee_text: string, arg_count:',
        'int32, callee_dotted: string, callee_qnames: list<item: struct<name: string,',
        'source: string>>, callee_fqns: list<item: string>, inferred_type: string,',
        "attrs: map<string, string>>>')) AS callsites_cast_type,",
        '      arrow_metadata(base.callsites) AS callsites_meta,',
        "      arrow_metadata(arrow_cast(base.callsites, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, call_id:',
        'string, call_bstart: int64, call_bend: int64, callee_bstart: int64,',
        'callee_bend: int64, callee_shape: string, callee_text: string, arg_count:',
        'int32, callee_dotted: string, callee_qnames: list<item: struct<name: string,',
        'source: string>>, callee_fqns: list<item: string>, inferred_type: string,',
        "attrs: map<string, string>>>')) AS callsites_cast_meta,",
        '      arrow_typeof(base.defs) AS defs_type,',
        "      arrow_typeof(arrow_cast(base.defs, 'list<item: struct<file_id: string",
        'not null, path: string not null, file_sha256: string, def_id: string,',
        'container_def_kind: string, container_def_bstart: int64, container_def_bend:',
        'int64, kind: string, name: string, def_bstart: int64, def_bend: int64,',
        'name_bstart: int64, name_bend: int64, qnames: list<item: struct<name:',
        'string, source: string>>, def_fqns: list<item: string>, docstring: string,',
        "decorator_count: int32, attrs: map<string, string>>>')) AS defs_cast_type,",
        '      arrow_metadata(base.defs) AS defs_meta,',
        "      arrow_metadata(arrow_cast(base.defs, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, def_id: string,',
        'container_def_kind: string, container_def_bstart: int64, container_def_bend:',
        'int64, kind: string, name: string, def_bstart: int64, def_bend: int64,',
        'name_bstart: int64, name_bend: int64, qnames: list<item: struct<name:',
        'string, source: string>>, def_fqns: list<item: string>, docstring: string,',
        "decorator_count: int32, attrs: map<string, string>>>')) AS defs_cast_meta,",
        '      arrow_typeof(base.type_exprs) AS type_exprs_type,',
        "      arrow_typeof(arrow_cast(base.type_exprs, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, owner_def_kind:',
        'string, owner_def_bstart: int64, owner_def_bend: int64, param_name: string,',
        'expr_kind: string, expr_role: string, bstart: int64, bend: int64, expr_text:',
        "string>>')) AS type_exprs_cast_type,",
        '      arrow_metadata(base.type_exprs) AS type_exprs_meta,',
        "      arrow_metadata(arrow_cast(base.type_exprs, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, owner_def_kind:',
        'string, owner_def_bstart: int64, owner_def_bend: int64, param_name: string,',
        'expr_kind: string, expr_role: string, bstart: int64, bend: int64, expr_text:',
        "string>>')) AS type_exprs_cast_meta,",
        '      arrow_typeof(base.docstrings) AS docstrings_type,',
        "      arrow_typeof(arrow_cast(base.docstrings, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, owner_def_id:',
        'string, owner_kind: string, owner_def_bstart: int64, owner_def_bend: int64,',
        "docstring: string, bstart: int64, bend: int64>>')) AS docstrings_cast_type,",
        '      arrow_metadata(base.docstrings) AS docstrings_meta,',
        "      arrow_metadata(arrow_cast(base.docstrings, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, owner_def_id:',
        'string, owner_kind: string, owner_def_bstart: int64, owner_def_bend: int64,',
        "docstring: string, bstart: int64, bend: int64>>')) AS docstrings_cast_meta,",
        '      arrow_typeof(base.decorators) AS decorators_type,',
        "      arrow_typeof(arrow_cast(base.decorators, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, owner_def_id:',
        'string, owner_kind: string, owner_def_bstart: int64, owner_def_bend: int64,',
        'decorator_text: string, decorator_index: int32, bstart: int64, bend:',
        "int64>>')) AS decorators_cast_type,",
        '      arrow_metadata(base.decorators) AS decorators_meta,',
        "      arrow_metadata(arrow_cast(base.decorators, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, owner_def_id:',
        'string, owner_kind: string, owner_def_bstart: int64, owner_def_bend: int64,',
        'decorator_text: string, decorator_index: int32, bstart: int64, bend:',
        "int64>>')) AS decorators_cast_meta,",
        '      arrow_typeof(base.call_args) AS call_args_type,',
        "      arrow_typeof(arrow_cast(base.call_args, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, call_id:',
        'string, call_bstart: int64, call_bend: int64, arg_index: int32, keyword:',
        "string, star: string, arg_text: string, bstart: int64, bend: int64>>')) AS",
        'call_args_cast_type,',
        '      arrow_metadata(base.call_args) AS call_args_meta,',
        "      arrow_metadata(arrow_cast(base.call_args, 'list<item: struct<file_id:",
        'string not null, path: string not null, file_sha256: string, call_id:',
        'string, call_bstart: int64, call_bend: int64, arg_index: int32, keyword:',
        "string, star: string, arg_text: string, bstart: int64, bend: int64>>')) AS",
        'call_args_cast_meta,',
        '      arrow_typeof(base.attrs) AS attrs_type,',
        '      arrow_metadata(base.attrs) AS attrs_meta',
        '    FROM base',
        "",
    ]),
    'cst_type_exprs': "\n".join([
        '    WITH base AS (SELECT',
        "      get_field(n0.n0_item, 'file_id') AS file_id,",
        "      get_field(n0.n0_item, 'path') AS path,",
        "      get_field(n0.n0_item, 'file_sha256') AS file_sha256,",
        "      get_field(n0.n0_item, 'owner_def_kind') AS owner_def_kind,",
        "      get_field(n0.n0_item, 'owner_def_bstart') AS owner_def_bstart,",
        "      get_field(n0.n0_item, 'owner_def_bend') AS owner_def_bend,",
        "      get_field(n0.n0_item, 'param_name') AS param_name,",
        "      get_field(n0.n0_item, 'expr_kind') AS expr_kind,",
        "      get_field(n0.n0_item, 'expr_role') AS expr_role,",
        "      get_field(n0.n0_item, 'bstart') AS bstart,",
        "      get_field(n0.n0_item, 'bend') AS bend,",
        "      get_field(n0.n0_item, 'expr_text') AS expr_text",
        'FROM libcst_files_v1 AS root',
        'CROSS JOIN unnest(root.type_exprs) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.file_sha256 AS file_sha256,',
        '      base.owner_def_kind AS owner_def_kind,',
        '      base.owner_def_bstart AS owner_def_bstart,',
        '      base.owner_def_bend AS owner_def_bend,',
        '      base.param_name AS param_name,',
        '      base.expr_kind AS expr_kind,',
        '      base.expr_role AS expr_role,',
        '      base.bstart AS bstart,',
        '      base.bend AS bend,',
        '      base.expr_text AS expr_text,',
        "      prefixed_hash64('cst_type_expr', concat_ws(':', base.path,",
        'base.bstart, base.bend)) AS type_expr_id,',
        "      prefixed_hash64('cst_def', concat_ws(':', base.file_id,",
        'base.owner_def_kind, base.owner_def_bstart, base.owner_def_bend)) AS',
        'owner_def_id',
        '    FROM base',
        "",
    ]),
    'py_bc_blocks': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'start_offset') AS start_offset,",
        "      get_field(n1.n1_item, 'end_offset') AS end_offset,",
        "      get_field(n1.n1_item, 'kind') AS kind,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'blocks')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.start_offset AS start_offset,',
        '      base.end_offset AS end_offset,',
        '      base.kind AS kind,',
        "      prefixed_hash64('bc_block', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.start_offset, base.end_offset)) AS block_id',
        '    FROM base',
        "",
    ]),
    'py_bc_cache_entries': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'instr_index') AS instr_index,",
        "      get_field(n1.n1_item, 'offset') AS offset,",
        "      get_field(n2.n2_item, 'name') AS name,",
        "      get_field(n2.n2_item, 'size') AS size,",
        "      get_field(n2.n2_item, 'data_hex') AS data_hex",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'instructions')) AS n1(n1_item)",
        "CROSS JOIN unnest(get_field(n1.n1_item, 'cache_info')) AS n2(n2_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.instr_index AS instr_index,',
        '      base.offset AS offset,',
        '      base.name AS name,',
        '      base.size AS size,',
        '      base.data_hex AS data_hex,',
        "      prefixed_hash64('bc_instr', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.instr_index, base.offset)) AS instr_id,',
        "      prefixed_hash64('bc_cache', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.instr_index, base.offset, base.name, base.size, base.data_hex)) AS',
        'cache_entry_id',
        '    FROM base',
        "",
    ]),
    'py_bc_cfg_edge_attrs': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'src_block_start') AS src_block_start,",
        "      get_field(n1.n1_item, 'src_block_end') AS src_block_end,",
        "      get_field(n1.n1_item, 'dst_block_start') AS dst_block_start,",
        "      get_field(n1.n1_item, 'dst_block_end') AS dst_block_end,",
        "      get_field(n1.n1_item, 'kind') AS kind,",
        "      get_field(n1.n1_item, 'edge_key') AS edge_key,",
        "      get_field(n1.n1_item, 'cond_instr_index') AS cond_instr_index,",
        "      get_field(n1.n1_item, 'cond_instr_offset') AS cond_instr_offset,",
        "      get_field(n1.n1_item, 'exc_index') AS exc_index,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'cfg_edges')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.edge_key AS edge_key,',
        '      base.kind AS kind,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value,",
        "      union_tag(get_field(kv, 'value')) AS attr_kind,",
        "      union_extract(get_field(kv, 'value'), 'int_value') AS attr_int,",
        "      union_extract(get_field(kv, 'value'), 'bool_value') AS attr_bool,",
        "      union_extract(get_field(kv, 'value'), 'str_value') AS attr_str",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'py_bc_cfg_edges': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'src_block_start') AS src_block_start,",
        "      get_field(n1.n1_item, 'src_block_end') AS src_block_end,",
        "      get_field(n1.n1_item, 'dst_block_start') AS dst_block_start,",
        "      get_field(n1.n1_item, 'dst_block_end') AS dst_block_end,",
        "      get_field(n1.n1_item, 'kind') AS kind,",
        "      get_field(n1.n1_item, 'edge_key') AS edge_key,",
        "      get_field(n1.n1_item, 'cond_instr_index') AS cond_instr_index,",
        "      get_field(n1.n1_item, 'cond_instr_offset') AS cond_instr_offset,",
        "      get_field(n1.n1_item, 'exc_index') AS exc_index,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'cfg_edges')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.src_block_start AS src_block_start,',
        '      base.src_block_end AS src_block_end,',
        '      base.dst_block_start AS dst_block_start,',
        '      base.dst_block_end AS dst_block_end,',
        '      base.kind AS kind,',
        '      base.edge_key AS edge_key,',
        "      list_extract(map_extract(base.attrs, 'jump_kind'), 1) AS jump_kind,",
        "      arrow_cast(list_extract(map_extract(base.attrs, 'jump_label'), 1),",
        "'Int32') AS jump_label,",
        '      base.cond_instr_index AS cond_instr_index,',
        '      base.cond_instr_offset AS cond_instr_offset,',
        '      base.exc_index AS exc_index,',
        "      prefixed_hash64('bc_block', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.src_block_start, base.src_block_end)) AS src_block_id,',
        "      prefixed_hash64('bc_block', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.dst_block_start, base.dst_block_end)) AS dst_block_id,',
        "      prefixed_hash64('bc_instr', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.cond_instr_index, base.cond_instr_offset)) AS cond_instr_id,',
        "      prefixed_hash64('bc_edge', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        "prefixed_hash64('bc_block', concat_ws(':', stable_id('code', concat_ws('\x1f',",
        "'code', coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        "base.src_block_start, base.src_block_end)), prefixed_hash64('bc_block',",
        "concat_ws(':', stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.dst_block_start, base.dst_block_end)), base.kind, base.edge_key,',
        'base.exc_index)) AS edge_id',
        '    FROM base',
        "",
    ]),
    'py_bc_code_units': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'code_id') AS code_id,",
        "      get_field(n0.n0_item, 'qualname') AS qualname,",
        "      get_field(n0.n0_item, 'co_qualname') AS co_qualname,",
        "      get_field(n0.n0_item, 'co_filename') AS co_filename,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS firstlineno1,",
        "      get_field(n0.n0_item, 'argcount') AS argcount,",
        "      get_field(n0.n0_item, 'posonlyargcount') AS posonlyargcount,",
        "      get_field(n0.n0_item, 'kwonlyargcount') AS kwonlyargcount,",
        "      get_field(n0.n0_item, 'nlocals') AS nlocals,",
        "      get_field(n0.n0_item, 'flags') AS flags,",
        "      get_field(n0.n0_item, 'flags_detail') AS flags_detail,",
        "      get_field(n0.n0_item, 'stacksize') AS stacksize,",
        "      get_field(n0.n0_item, 'code_len') AS code_len,",
        "      get_field(n0.n0_item, 'varnames') AS varnames,",
        "      get_field(n0.n0_item, 'freevars') AS freevars,",
        "      get_field(n0.n0_item, 'cellvars') AS cellvars,",
        "      get_field(n0.n0_item, 'names') AS names,",
        "      get_field(n0.n0_item, 'consts') AS consts,",
        "      get_field(n0.n0_item, 'consts_json') AS consts_json,",
        "      get_field(n0.n0_item, 'line_table') AS line_table,",
        "      get_field(n0.n0_item, 'instructions') AS instructions,",
        "      get_field(n0.n0_item, 'exception_table') AS exception_table,",
        "      get_field(n0.n0_item, 'blocks') AS blocks,",
        "      get_field(n0.n0_item, 'cfg_edges') AS cfg_edges,",
        "      get_field(n0.n0_item, 'dfg_edges') AS dfg_edges,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code', coalesce(CAST(base.qualname",
        "AS STRING), 'None'), coalesce(CAST(base.name AS STRING), 'None'),",
        "coalesce(CAST(base.firstlineno1 AS STRING), 'None'))) AS code_unit_id,",
        '      base.qualname AS qualpath,',
        '      base.co_qualname AS co_qualname,',
        '      base.co_filename AS co_filename,',
        '      base.name AS co_name,',
        '      base.firstlineno1 AS firstlineno,',
        '      base.argcount AS argcount,',
        '      base.posonlyargcount AS posonlyargcount,',
        '      base.kwonlyargcount AS kwonlyargcount,',
        '      base.nlocals AS nlocals,',
        '      base.flags AS flags,',
        '      base.flags_detail AS flags_detail,',
        '      base.stacksize AS stacksize,',
        '      base.code_len AS code_len,',
        '      base.varnames AS varnames,',
        '      base.freevars AS freevars,',
        '      base.cellvars AS cellvars,',
        '      base.names AS names,',
        '      base.consts AS consts,',
        '      base.consts_json AS consts_json',
        '    FROM base',
        "",
    ]),
    'py_bc_consts': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'const_index') AS const_index,",
        "      get_field(n1.n1_item, 'const_repr') AS const_repr",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'consts')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.const_index AS const_index,',
        '      base.const_repr AS const_repr,',
        "      prefixed_hash64('bc_const', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.const_index, base.const_repr)) AS const_id',
        '    FROM base',
        "",
    ]),
    'py_bc_dfg_edges': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'src_instr_index') AS src_instr_index,",
        "      get_field(n1.n1_item, 'dst_instr_index') AS dst_instr_index,",
        "      get_field(n1.n1_item, 'kind') AS kind,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'dfg_edges')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.src_instr_index AS src_instr_index,',
        '      base.dst_instr_index AS dst_instr_index,',
        '      base.kind AS kind,',
        "      prefixed_hash64('bc_dfg', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.src_instr_index, base.dst_instr_index, base.kind)) AS edge_id',
        '    FROM base',
        "",
    ]),
    'py_bc_error_attrs': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'error_type') AS error_type,",
        "      get_field(n0.n0_item, 'message') AS message,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.errors) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.error_type AS error_type,',
        '      base.message AS message,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value,",
        "      union_tag(get_field(kv, 'value')) AS attr_kind,",
        "      union_extract(get_field(kv, 'value'), 'int_value') AS attr_int,",
        "      union_extract(get_field(kv, 'value'), 'bool_value') AS attr_bool,",
        "      union_extract(get_field(kv, 'value'), 'str_value') AS attr_str",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'py_bc_flags_detail': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'code_id') AS code_id,",
        "      get_field(n0.n0_item, 'qualname') AS qualname,",
        "      get_field(n0.n0_item, 'co_qualname') AS co_qualname,",
        "      get_field(n0.n0_item, 'co_filename') AS co_filename,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS firstlineno1,",
        "      get_field(n0.n0_item, 'argcount') AS argcount,",
        "      get_field(n0.n0_item, 'posonlyargcount') AS posonlyargcount,",
        "      get_field(n0.n0_item, 'kwonlyargcount') AS kwonlyargcount,",
        "      get_field(n0.n0_item, 'nlocals') AS nlocals,",
        "      get_field(n0.n0_item, 'flags') AS flags,",
        "      get_field(n0.n0_item, 'flags_detail') AS flags_detail,",
        "      get_field(n0.n0_item, 'stacksize') AS stacksize,",
        "      get_field(n0.n0_item, 'code_len') AS code_len,",
        "      get_field(n0.n0_item, 'varnames') AS varnames,",
        "      get_field(n0.n0_item, 'freevars') AS freevars,",
        "      get_field(n0.n0_item, 'cellvars') AS cellvars,",
        "      get_field(n0.n0_item, 'names') AS names,",
        "      get_field(n0.n0_item, 'consts') AS consts,",
        "      get_field(n0.n0_item, 'consts_json') AS consts_json,",
        "      get_field(n0.n0_item, 'line_table') AS line_table,",
        "      get_field(n0.n0_item, 'instructions') AS instructions,",
        "      get_field(n0.n0_item, 'exception_table') AS exception_table,",
        "      get_field(n0.n0_item, 'blocks') AS blocks,",
        "      get_field(n0.n0_item, 'cfg_edges') AS cfg_edges,",
        "      get_field(n0.n0_item, 'dfg_edges') AS dfg_edges,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code', coalesce(CAST(base.qualname",
        "AS STRING), 'None'), coalesce(CAST(base.name AS STRING), 'None'),",
        "coalesce(CAST(base.firstlineno1 AS STRING), 'None'))) AS code_unit_id,",
        "      get_field(base.flags_detail, 'is_optimized') AS is_optimized,",
        "      get_field(base.flags_detail, 'is_newlocals') AS is_newlocals,",
        "      get_field(base.flags_detail, 'has_varargs') AS has_varargs,",
        "      get_field(base.flags_detail, 'has_varkeywords') AS has_varkeywords,",
        "      get_field(base.flags_detail, 'is_nested') AS is_nested,",
        "      get_field(base.flags_detail, 'is_generator') AS is_generator,",
        "      get_field(base.flags_detail, 'is_nofree') AS is_nofree,",
        "      get_field(base.flags_detail, 'is_coroutine') AS is_coroutine,",
        "      get_field(base.flags_detail, 'is_iterable_coroutine') AS",
        'is_iterable_coroutine,',
        "      get_field(base.flags_detail, 'is_async_generator') AS",
        'is_async_generator',
        '    FROM base',
        "",
    ]),
    'py_bc_instruction_attr_keys': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'instr_index') AS instr_index,",
        "      get_field(n1.n1_item, 'offset') AS offset,",
        "      get_field(n1.n1_item, 'start_offset') AS start_offset,",
        "      get_field(n1.n1_item, 'end_offset') AS end_offset,",
        "      get_field(n1.n1_item, 'opname') AS opname,",
        "      get_field(n1.n1_item, 'baseopname') AS baseopname,",
        "      get_field(n1.n1_item, 'opcode') AS opcode,",
        "      get_field(n1.n1_item, 'baseopcode') AS baseopcode,",
        "      get_field(n1.n1_item, 'arg') AS arg,",
        "      get_field(n1.n1_item, 'oparg') AS oparg,",
        "      get_field(n1.n1_item, 'argval_kind') AS argval_kind,",
        "      get_field(n1.n1_item, 'argval_int') AS argval_int,",
        "      get_field(n1.n1_item, 'argval_str') AS argval_str,",
        "      get_field(n1.n1_item, 'argrepr') AS argrepr,",
        "      get_field(n1.n1_item, 'line_number') AS line_number,",
        "      get_field(n1.n1_item, 'starts_line') AS starts_line,",
        "      get_field(n1.n1_item, 'label') AS label,",
        "      get_field(n1.n1_item, 'is_jump_target') AS is_jump_target,",
        "      get_field(n1.n1_item, 'jump_target') AS jump_target,",
        "      get_field(n1.n1_item, 'cache_info') AS cache_info,",
        "      get_field(n1.n1_item, 'span') AS span,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'instructions')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.instr_index AS instr_index,',
        '      base.offset AS offset,',
        '      unnest(map_keys(base.attrs)) AS attr_key',
        '    FROM base',
        "",
    ]),
    'py_bc_instruction_attr_values': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'instr_index') AS instr_index,",
        "      get_field(n1.n1_item, 'offset') AS offset,",
        "      get_field(n1.n1_item, 'start_offset') AS start_offset,",
        "      get_field(n1.n1_item, 'end_offset') AS end_offset,",
        "      get_field(n1.n1_item, 'opname') AS opname,",
        "      get_field(n1.n1_item, 'baseopname') AS baseopname,",
        "      get_field(n1.n1_item, 'opcode') AS opcode,",
        "      get_field(n1.n1_item, 'baseopcode') AS baseopcode,",
        "      get_field(n1.n1_item, 'arg') AS arg,",
        "      get_field(n1.n1_item, 'oparg') AS oparg,",
        "      get_field(n1.n1_item, 'argval_kind') AS argval_kind,",
        "      get_field(n1.n1_item, 'argval_int') AS argval_int,",
        "      get_field(n1.n1_item, 'argval_str') AS argval_str,",
        "      get_field(n1.n1_item, 'argrepr') AS argrepr,",
        "      get_field(n1.n1_item, 'line_number') AS line_number,",
        "      get_field(n1.n1_item, 'starts_line') AS starts_line,",
        "      get_field(n1.n1_item, 'label') AS label,",
        "      get_field(n1.n1_item, 'is_jump_target') AS is_jump_target,",
        "      get_field(n1.n1_item, 'jump_target') AS jump_target,",
        "      get_field(n1.n1_item, 'cache_info') AS cache_info,",
        "      get_field(n1.n1_item, 'span') AS span,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'instructions')) AS n1(n1_item)),",
        '    expanded AS (',
        '      SELECT',
        '        base.file_id AS file_id,',
        '        base.path AS path,',
        "        stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '        base.instr_index AS instr_index,',
        '        base.offset AS offset,',
        '        unnest(map_values(base.attrs)) AS attr_value',
        '      FROM base',
        '    )',
        '    SELECT',
        '      expanded.file_id AS file_id,',
        '      expanded.path AS path,',
        '      expanded.code_unit_id AS code_unit_id,',
        '      expanded.instr_index AS instr_index,',
        '      expanded.offset AS offset,',
        '      expanded.attr_value AS attr_value,',
        '      union_tag(expanded.attr_value) AS attr_kind,',
        "      union_extract(expanded.attr_value, 'int_value') AS attr_int,",
        "      union_extract(expanded.attr_value, 'bool_value') AS attr_bool,",
        "      union_extract(expanded.attr_value, 'str_value') AS attr_str",
        '    FROM expanded',
        "",
    ]),
    'py_bc_instruction_attrs': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'instr_index') AS instr_index,",
        "      get_field(n1.n1_item, 'offset') AS offset,",
        "      get_field(n1.n1_item, 'start_offset') AS start_offset,",
        "      get_field(n1.n1_item, 'end_offset') AS end_offset,",
        "      get_field(n1.n1_item, 'opname') AS opname,",
        "      get_field(n1.n1_item, 'baseopname') AS baseopname,",
        "      get_field(n1.n1_item, 'opcode') AS opcode,",
        "      get_field(n1.n1_item, 'baseopcode') AS baseopcode,",
        "      get_field(n1.n1_item, 'arg') AS arg,",
        "      get_field(n1.n1_item, 'oparg') AS oparg,",
        "      get_field(n1.n1_item, 'argval_kind') AS argval_kind,",
        "      get_field(n1.n1_item, 'argval_int') AS argval_int,",
        "      get_field(n1.n1_item, 'argval_str') AS argval_str,",
        "      get_field(n1.n1_item, 'argrepr') AS argrepr,",
        "      get_field(n1.n1_item, 'line_number') AS line_number,",
        "      get_field(n1.n1_item, 'starts_line') AS starts_line,",
        "      get_field(n1.n1_item, 'label') AS label,",
        "      get_field(n1.n1_item, 'is_jump_target') AS is_jump_target,",
        "      get_field(n1.n1_item, 'jump_target') AS jump_target,",
        "      get_field(n1.n1_item, 'cache_info') AS cache_info,",
        "      get_field(n1.n1_item, 'span') AS span,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'instructions')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.instr_index AS instr_index,',
        '      base.offset AS offset,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value,",
        "      union_tag(get_field(kv, 'value')) AS attr_kind,",
        "      union_extract(get_field(kv, 'value'), 'int_value') AS attr_int,",
        "      union_extract(get_field(kv, 'value'), 'bool_value') AS attr_bool,",
        "      union_extract(get_field(kv, 'value'), 'str_value') AS attr_str",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'py_bc_instruction_span_fields': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM py_bc_instruction_spans',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.code_unit_id AS code_unit_id,',
        '      base.instr_id AS instr_id,',
        '      base.instr_index AS instr_index,',
        '      base.offset AS offset,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS pos_start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS pos_start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS pos_end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS pos_end_col,",
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive",
        '    FROM base',
        "",
    ]),
    'py_bc_instruction_spans': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM py_bc_instructions',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.code_unit_id AS code_unit_id,',
        '      base.instr_id AS instr_id,',
        '      base.instr_index AS instr_index,',
        '      base.offset AS offset,',
        "      named_struct('start', named_struct('line0', base.pos_start_line,",
        "'col', base.pos_start_col), 'end', named_struct('line0', base.pos_end_line,",
        "'col', base.pos_end_col), 'col_unit', base.col_unit, 'end_exclusive',",
        'base.end_exclusive) AS span',
        '    FROM base',
        "",
    ]),
    'py_bc_instructions': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'instr_index') AS instr_index,",
        "      get_field(n1.n1_item, 'offset') AS offset,",
        "      get_field(n1.n1_item, 'start_offset') AS start_offset,",
        "      get_field(n1.n1_item, 'end_offset') AS end_offset,",
        "      get_field(n1.n1_item, 'opname') AS opname,",
        "      get_field(n1.n1_item, 'baseopname') AS baseopname,",
        "      get_field(n1.n1_item, 'opcode') AS opcode,",
        "      get_field(n1.n1_item, 'baseopcode') AS baseopcode,",
        "      get_field(n1.n1_item, 'arg') AS arg,",
        "      get_field(n1.n1_item, 'oparg') AS oparg,",
        "      get_field(n1.n1_item, 'argval_kind') AS argval_kind,",
        "      get_field(n1.n1_item, 'argval_int') AS argval_int,",
        "      get_field(n1.n1_item, 'argval_str') AS argval_str,",
        "      get_field(n1.n1_item, 'argrepr') AS argrepr,",
        "      get_field(n1.n1_item, 'line_number') AS line_number,",
        "      get_field(n1.n1_item, 'starts_line') AS starts_line,",
        "      get_field(n1.n1_item, 'label') AS label,",
        "      get_field(n1.n1_item, 'is_jump_target') AS is_jump_target,",
        "      get_field(n1.n1_item, 'jump_target') AS jump_target,",
        "      get_field(n1.n1_item, 'cache_info') AS cache_info,",
        "      get_field(n1.n1_item, 'span') AS span,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'instructions')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.instr_index AS instr_index,',
        '      base.offset AS offset,',
        '      base.start_offset AS start_offset,',
        '      base.end_offset AS end_offset,',
        '      base.opname AS opname,',
        '      base.baseopname AS baseopname,',
        '      base.opcode AS opcode,',
        '      base.baseopcode AS baseopcode,',
        '      base.arg AS arg,',
        '      base.oparg AS oparg,',
        '      base.argval_kind AS argval_kind,',
        '      base.argval_int AS argval_int,',
        '      base.argval_str AS argval_str,',
        '      base.argrepr AS argrepr,',
        '      base.line_number AS line_number,',
        '      base.starts_line AS starts_line,',
        '      base.label AS label,',
        '      base.is_jump_target AS is_jump_target,',
        '      base.jump_target AS jump_target_offset,',
        '      base.cache_info AS cache_info,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS pos_start_line,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS pos_end_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS pos_start_col,",
        "      get_field(get_field(base.span, 'end'), 'col') AS pos_end_col,",
        "      arrow_cast(arrow_metadata(base.span, 'line_base'), 'Int32') AS",
        'line_base,',
        "      arrow_metadata(base.span, 'col_unit') AS col_unit,",
        "      CASE WHEN LOWER(arrow_metadata(base.span, 'end_exclusive')) = 'true'",
        "THEN TRUE WHEN LOWER(arrow_metadata(base.span, 'end_exclusive')) = 'false'",
        'THEN FALSE ELSE NULL END AS end_exclusive,',
        '      union_extract(list_extract(map_extract(base.attrs,',
        "'stack_depth_before'), 1), 'int_value') AS stack_depth_before,",
        '      union_extract(list_extract(map_extract(base.attrs,',
        "'stack_depth_after'), 1), 'int_value') AS stack_depth_after,",
        "      prefixed_hash64('bc_instr', concat_ws(':', stable_id('code',",
        "concat_ws('\x1f', 'code', coalesce(CAST(base.code_unit_qualpath AS STRING),",
        "'None'), coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))),",
        'base.instr_index, base.offset)) AS instr_id',
        '    FROM base',
        "",
    ]),
    'py_bc_line_table': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'qualname') AS code_unit_qualpath,",
        "      get_field(n0.n0_item, 'name') AS code_unit_name,",
        "      get_field(n0.n0_item, 'firstlineno1') AS code_unit_firstlineno,",
        "      get_field(n1.n1_item, 'offset') AS offset,",
        "      get_field(n1.n1_item, 'line1') AS line1,",
        "      get_field(n1.n1_item, 'line0') AS line0,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM bytecode_files_v1 AS root',
        'CROSS JOIN unnest(root.code_objects) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'line_table')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        "      stable_id('code', concat_ws('\x1f', 'code',",
        "coalesce(CAST(base.code_unit_qualpath AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_name AS STRING), 'None'),",
        "coalesce(CAST(base.code_unit_firstlineno AS STRING), 'None'))) AS",
        'code_unit_id,',
        '      base.offset AS offset,',
        '      base.line1 AS line1,',
        '      base.line0 AS line0,',
        "      arrow_cast(arrow_metadata(base.line1, 'line_base'), 'Int32') AS",
        'line_base',
        '    FROM base',
        "",
    ]),
    'py_bc_metadata': "\n".join([
        '    SELECT',
        '      arrow_metadata(code_objects.instructions) AS instructions_metadata,',
        '      arrow_metadata(code_objects.line_table) AS line_table_metadata',
        '    FROM bytecode_files_v1',
        '    LIMIT 1',
        "",
    ]),
    'scip_diagnostics': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM scip_diagnostics_v1',
        '    )',
        '    SELECT',
        '      CASE',
        "        WHEN base.path IS NULL OR base.path = '' THEN NULL",
        "        ELSE stable_id('scip_doc', concat_ws('\x1f', 'scip_doc',",
        "coalesce(CAST(base.path AS STRING), 'None')))",
        '      END AS document_id,',
        '      base.path AS path,',
        '      base.severity AS severity,',
        '      base.message AS message,',
        '      base.raw_line AS raw_line,',
        '      base.raw_column AS raw_column,',
        '      base.editor_line AS editor_line,',
        '      base.editor_column AS editor_column,',
        '      base.context AS context,',
        '      base.line_base AS line_base,',
        '      base.col_unit AS col_unit,',
        '      base.end_exclusive AS end_exclusive',
        '    FROM base',
        "",
    ]),
    'scip_document_symbols': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM scip_document_symbols_v1',
        '    )',
        '    SELECT',
        '      CASE',
        "        WHEN base.path IS NULL OR base.path = '' THEN NULL",
        "        ELSE stable_id('scip_doc', concat_ws('\x1f', 'scip_doc',",
        "coalesce(CAST(base.path AS STRING), 'None')))",
        '      END AS document_id,',
        '      base.path AS path,',
        '      base.symbol AS symbol,',
        '      base.display_name AS display_name,',
        '      base.kind AS kind,',
        '      base.kind_name AS kind_name,',
        '      base.enclosing_symbol AS enclosing_symbol,',
        '      base.documentation AS documentation,',
        '      base.signature_text AS signature_text,',
        '      base.signature_language AS signature_language',
        '    FROM base',
        "",
    ]),
    'scip_document_texts': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM scip_document_texts_v1',
        '    )',
        '    SELECT',
        '      CASE',
        "        WHEN base.path IS NULL OR base.path = '' THEN NULL",
        "        ELSE stable_id('scip_doc', concat_ws('\x1f', 'scip_doc',",
        "coalesce(CAST(base.path AS STRING), 'None')))",
        '      END AS document_id,',
        '      base.path AS path,',
        '      base.text AS text',
        '    FROM base',
        "",
    ]),
    'scip_documents': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM scip_documents_v1',
        '    )',
        '    SELECT',
        '      CASE',
        "        WHEN base.index_path IS NULL OR base.index_path = '' THEN NULL",
        "        ELSE stable_id('scip_index', concat_ws('\x1f', 'scip_index',",
        "coalesce(CAST(base.index_path AS STRING), 'None')))",
        '      END AS index_id,',
        '      CASE',
        "        WHEN base.path IS NULL OR base.path = '' THEN NULL",
        "        ELSE stable_id('scip_doc', concat_ws('\x1f', 'scip_doc',",
        "coalesce(CAST(base.path AS STRING), 'None')))",
        '      END AS document_id,',
        '      base.path AS path,',
        '      base.language AS language,',
        '      base.position_encoding AS position_encoding',
        '    FROM base',
        "",
    ]),
    'scip_external_symbol_information': "\n".join([
        'SELECT * FROM scip_external_symbol_information_v1',
    ]),
    'scip_index_stats': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM scip_index_stats_v1',
        '    )',
        '    SELECT',
        '      CASE',
        "        WHEN base.index_path IS NULL OR base.index_path = '' THEN NULL",
        "        ELSE stable_id('scip_index', concat_ws('\x1f', 'scip_index',",
        "coalesce(CAST(base.index_path AS STRING), 'None')))",
        '      END AS index_id,',
        '      base.document_count AS document_count,',
        '      base.occurrence_count AS occurrence_count,',
        '      base.diagnostic_count AS diagnostic_count,',
        '      base.symbol_count AS symbol_count,',
        '      base.external_symbol_count AS external_symbol_count,',
        '      base.missing_position_encoding_count AS',
        'missing_position_encoding_count,',
        '      base.document_text_count AS document_text_count,',
        '      base.document_text_bytes AS document_text_bytes',
        '    FROM base',
        "",
    ]),
    'scip_metadata': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM scip_metadata_v1',
        '    )',
        '    SELECT',
        '      CASE',
        "        WHEN base.index_path IS NULL OR base.index_path = '' THEN NULL",
        "        ELSE stable_id('scip_index', concat_ws('\x1f', 'scip_index',",
        "coalesce(CAST(base.index_path AS STRING), 'None')))",
        '      END AS index_id,',
        '      base.protocol_version AS protocol_version,',
        '      base.tool_name AS tool_name,',
        '      base.tool_version AS tool_version,',
        '      base.tool_arguments AS tool_arguments,',
        '      base.project_root AS project_root,',
        '      base.text_document_encoding AS text_document_encoding,',
        '      base.project_name AS project_name,',
        '      base.project_version AS project_version,',
        '      base.project_namespace AS project_namespace',
        '    FROM base',
        "",
    ]),
    'scip_occurrences': "\n".join([
        '    WITH base AS (',
        '      SELECT * FROM scip_occurrences_v1',
        '    )',
        '    SELECT',
        '      CASE',
        "        WHEN base.path IS NULL OR base.path = '' THEN NULL",
        "        ELSE stable_id('scip_doc', concat_ws('\x1f', 'scip_doc',",
        "coalesce(CAST(base.path AS STRING), 'None')))",
        '      END AS document_id,',
        '      base.path AS path,',
        '      base.symbol AS symbol,',
        '      base.symbol_roles AS symbol_roles,',
        '      base.syntax_kind AS syntax_kind,',
        '      base.syntax_kind_name AS syntax_kind_name,',
        '      base.override_documentation AS override_documentation,',
        '      base.range_raw AS range_raw,',
        '      base.enclosing_range_raw AS enclosing_range_raw,',
        '      base.start_line AS start_line,',
        '      base.start_char AS start_char,',
        '      base.end_line AS end_line,',
        '      base.end_char AS end_char,',
        '      base.range_len AS range_len,',
        '      base.enc_start_line AS enc_start_line,',
        '      base.enc_start_char AS enc_start_char,',
        '      base.enc_end_line AS enc_end_line,',
        '      base.enc_end_char AS enc_end_char,',
        '      base.enc_range_len AS enc_range_len,',
        '      base.line_base AS line_base,',
        '      base.col_unit AS col_unit,',
        '      base.end_exclusive AS end_exclusive,',
        '      base.is_definition AS is_definition,',
        '      base.is_import AS is_import,',
        '      base.is_write AS is_write,',
        '      base.is_read AS is_read,',
        '      base.is_generated AS is_generated,',
        '      base.is_test AS is_test,',
        '      base.is_forward_definition AS is_forward_definition',
        '    FROM base',
        "",
    ]),
    'scip_signature_occurrences': "\n".join([
        'SELECT * FROM scip_signature_occurrences_v1',
    ]),
    'scip_symbol_information': "\n".join([
        'SELECT * FROM scip_symbol_information_v1',
    ]),
    'scip_symbol_relationships': "\n".join([
        'SELECT * FROM scip_symbol_relationships_v1',
    ]),
    'symtable_class_methods': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'parent_block_id') AS parent_block_id,",
        "      get_field(n0.n0_item, 'block_type') AS block_type,",
        "      get_field(n0.n0_item, 'is_meta_scope') AS is_meta_scope,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'lineno1') AS lineno1,",
        "      get_field(n0.n0_item, 'span_hint') AS span_hint,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n0.n0_item, 'scope_local_id') AS scope_local_id,",
        "      get_field(n0.n0_item, 'scope_type_value') AS scope_type_value,",
        "      get_field(n0.n0_item, 'qualpath') AS qualpath,",
        "      get_field(n0.n0_item, 'function_partitions') AS function_partitions,",
        "      get_field(n0.n0_item, 'class_methods') AS class_methods,",
        "      get_field(n0.n0_item, 'symbols') AS symbols,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.scope_id AS scope_id,',
        '      base.scope_name AS scope_name,',
        '      method_name AS method_name',
        '    FROM base',
        '    CROSS JOIN unnest(base.class_methods) AS method_name',
        "",
    ]),
    'symtable_function_partitions': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'parent_block_id') AS parent_block_id,",
        "      get_field(n0.n0_item, 'block_type') AS block_type,",
        "      get_field(n0.n0_item, 'is_meta_scope') AS is_meta_scope,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'lineno1') AS lineno1,",
        "      get_field(n0.n0_item, 'span_hint') AS span_hint,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n0.n0_item, 'scope_local_id') AS scope_local_id,",
        "      get_field(n0.n0_item, 'scope_type_value') AS scope_type_value,",
        "      get_field(n0.n0_item, 'qualpath') AS qualpath,",
        "      get_field(n0.n0_item, 'function_partitions') AS function_partitions,",
        "      get_field(n0.n0_item, 'class_methods') AS class_methods,",
        "      get_field(n0.n0_item, 'symbols') AS symbols,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.scope_id AS scope_id,',
        '      base.scope_name AS scope_name,',
        "      get_field(base.function_partitions, 'parameters') AS parameters,",
        "      get_field(base.function_partitions, 'locals') AS locals,",
        "      get_field(base.function_partitions, 'globals') AS globals,",
        "      get_field(base.function_partitions, 'nonlocals') AS nonlocals,",
        "      get_field(base.function_partitions, 'frees') AS frees",
        '    FROM base',
        '    WHERE base.function_partitions IS NOT NULL',
        "",
    ]),
    'symtable_namespace_edges': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n1.n1_item, 'name') AS name,",
        "      get_field(n1.n1_item, 'sym_symbol_id') AS sym_symbol_id,",
        "      get_field(n1.n1_item, 'flags') AS flags,",
        "      get_field(n1.n1_item, 'namespace_count') AS namespace_count,",
        "      get_field(n1.n1_item, 'namespace_block_ids') AS namespace_block_ids,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'symbols')) AS n1(n1_item)),",
        '    scopes AS (',
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'parent_block_id') AS parent_block_id,",
        "      get_field(n0.n0_item, 'block_type') AS block_type,",
        "      get_field(n0.n0_item, 'is_meta_scope') AS is_meta_scope,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'lineno1') AS lineno1,",
        "      get_field(n0.n0_item, 'span_hint') AS span_hint,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n0.n0_item, 'scope_local_id') AS scope_local_id,",
        "      get_field(n0.n0_item, 'scope_type_value') AS scope_type_value,",
        "      get_field(n0.n0_item, 'qualpath') AS qualpath,",
        "      get_field(n0.n0_item, 'function_partitions') AS function_partitions,",
        "      get_field(n0.n0_item, 'class_methods') AS class_methods,",
        "      get_field(n0.n0_item, 'symbols') AS symbols,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.block_id AS table_id,',
        '      base.scope_id AS scope_id,',
        '      base.scope_local_id AS scope_local_id,',
        '      base.block_type AS scope_type,',
        '      base.scope_type_value AS scope_type_value,',
        '      base.name AS scope_name,',
        '      base.qualpath AS qualpath,',
        '      base.function_partitions AS function_partitions,',
        '      base.class_methods AS class_methods,',
        '      base.lineno1 AS lineno,',
        '      base.is_meta_scope AS is_meta_scope,',
        '      base.parent_block_id AS parent_table_id',
        '    FROM base',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.scope_id AS scope_id,',
        '      base.name AS symbol_name,',
        '      child_block_id AS child_table_id,',
        '      child.scope_id AS child_scope_id,',
        '      base.namespace_count AS namespace_count',
        '    FROM base',
        '    CROSS JOIN unnest(base.namespace_block_ids) AS child_block_id',
        '    LEFT JOIN scopes child',
        '      ON child.table_id = child_block_id',
        '     AND child.path = base.path',
        "",
    ]),
    'symtable_scope_edges': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'parent_block_id') AS parent_block_id,",
        "      get_field(n0.n0_item, 'block_type') AS block_type,",
        "      get_field(n0.n0_item, 'is_meta_scope') AS is_meta_scope,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'lineno1') AS lineno1,",
        "      get_field(n0.n0_item, 'span_hint') AS span_hint,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n0.n0_item, 'scope_local_id') AS scope_local_id,",
        "      get_field(n0.n0_item, 'scope_type_value') AS scope_type_value,",
        "      get_field(n0.n0_item, 'qualpath') AS qualpath,",
        "      get_field(n0.n0_item, 'function_partitions') AS function_partitions,",
        "      get_field(n0.n0_item, 'class_methods') AS class_methods,",
        "      get_field(n0.n0_item, 'symbols') AS symbols,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item)),',
        '    scopes AS (',
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'parent_block_id') AS parent_block_id,",
        "      get_field(n0.n0_item, 'block_type') AS block_type,",
        "      get_field(n0.n0_item, 'is_meta_scope') AS is_meta_scope,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'lineno1') AS lineno1,",
        "      get_field(n0.n0_item, 'span_hint') AS span_hint,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n0.n0_item, 'scope_local_id') AS scope_local_id,",
        "      get_field(n0.n0_item, 'scope_type_value') AS scope_type_value,",
        "      get_field(n0.n0_item, 'qualpath') AS qualpath,",
        "      get_field(n0.n0_item, 'function_partitions') AS function_partitions,",
        "      get_field(n0.n0_item, 'class_methods') AS class_methods,",
        "      get_field(n0.n0_item, 'symbols') AS symbols,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.block_id AS table_id,',
        '      base.scope_id AS scope_id,',
        '      base.scope_local_id AS scope_local_id,',
        '      base.block_type AS scope_type,',
        '      base.scope_type_value AS scope_type_value,',
        '      base.name AS scope_name,',
        '      base.qualpath AS qualpath,',
        '      base.function_partitions AS function_partitions,',
        '      base.class_methods AS class_methods,',
        '      base.lineno1 AS lineno,',
        '      base.is_meta_scope AS is_meta_scope,',
        '      base.parent_block_id AS parent_table_id',
        '    FROM base',
        '    )',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.parent_block_id AS parent_table_id,',
        '      base.block_id AS child_table_id,',
        '      parent.scope_id AS parent_scope_id,',
        '      child.scope_id AS child_scope_id',
        '    FROM base',
        '    LEFT JOIN scopes parent',
        '      ON parent.table_id = base.parent_block_id',
        '     AND parent.path = base.path',
        '    LEFT JOIN scopes child',
        '      ON child.table_id = base.block_id',
        '     AND child.path = base.path',
        "",
    ]),
    'symtable_scopes': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'parent_block_id') AS parent_block_id,",
        "      get_field(n0.n0_item, 'block_type') AS block_type,",
        "      get_field(n0.n0_item, 'is_meta_scope') AS is_meta_scope,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'lineno1') AS lineno1,",
        "      get_field(n0.n0_item, 'span_hint') AS span_hint,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n0.n0_item, 'scope_local_id') AS scope_local_id,",
        "      get_field(n0.n0_item, 'scope_type_value') AS scope_type_value,",
        "      get_field(n0.n0_item, 'qualpath') AS qualpath,",
        "      get_field(n0.n0_item, 'function_partitions') AS function_partitions,",
        "      get_field(n0.n0_item, 'class_methods') AS class_methods,",
        "      get_field(n0.n0_item, 'symbols') AS symbols,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.block_id AS table_id,',
        '      base.scope_id AS scope_id,',
        '      base.scope_local_id AS scope_local_id,',
        '      base.block_type AS scope_type,',
        '      base.scope_type_value AS scope_type_value,',
        '      base.name AS scope_name,',
        '      base.qualpath AS qualpath,',
        '      base.function_partitions AS function_partitions,',
        '      base.class_methods AS class_methods,',
        '      base.lineno1 AS lineno,',
        '      base.is_meta_scope AS is_meta_scope,',
        '      base.parent_block_id AS parent_table_id',
        '    FROM base',
        "",
    ]),
    'symtable_symbol_attrs': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n1.n1_item, 'name') AS name,",
        "      get_field(n1.n1_item, 'sym_symbol_id') AS sym_symbol_id,",
        "      get_field(n1.n1_item, 'flags') AS flags,",
        "      get_field(n1.n1_item, 'namespace_count') AS namespace_count,",
        "      get_field(n1.n1_item, 'namespace_block_ids') AS namespace_block_ids,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'symbols')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.scope_id AS scope_id,',
        '      base.name AS symbol_name,',
        "      get_field(kv, 'key') AS attr_key,",
        "      get_field(kv, 'value') AS attr_value",
        '    FROM base',
        '    CROSS JOIN unnest(map_entries(base.attrs)) AS kv',
        "",
    ]),
    'symtable_symbols': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'block_id') AS block_id,",
        "      get_field(n0.n0_item, 'scope_id') AS scope_id,",
        "      get_field(n1.n1_item, 'name') AS name,",
        "      get_field(n1.n1_item, 'sym_symbol_id') AS sym_symbol_id,",
        "      get_field(n1.n1_item, 'flags') AS flags,",
        "      get_field(n1.n1_item, 'namespace_count') AS namespace_count,",
        "      get_field(n1.n1_item, 'namespace_block_ids') AS namespace_block_ids,",
        "      get_field(n1.n1_item, 'attrs') AS attrs",
        'FROM symtable_files_v1 AS root',
        'CROSS JOIN unnest(root.blocks) AS n0(n0_item)',
        "CROSS JOIN unnest(get_field(n0.n0_item, 'symbols')) AS n1(n1_item))",
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.block_id AS table_id,',
        '      base.scope_id AS scope_id,',
        '      base.name AS symbol_name,',
        '      CASE',
        '        WHEN base.scope_id IS NULL OR base.name IS NULL',
        '        THEN NULL',
        "        ELSE prefixed_hash64('sym_symbol', concat_ws(':', base.scope_id,",
        'base.name))',
        '      END AS sym_symbol_id,',
        "      get_field(base.flags, 'is_referenced') AS is_referenced,",
        "      get_field(base.flags, 'is_imported') AS is_imported,",
        "      get_field(base.flags, 'is_parameter') AS is_parameter,",
        "      get_field(base.flags, 'is_type_parameter') AS is_type_parameter,",
        "      get_field(base.flags, 'is_global') AS is_global,",
        "      get_field(base.flags, 'is_nonlocal') AS is_nonlocal,",
        "      get_field(base.flags, 'is_declared_global') AS is_declared_global,",
        "      get_field(base.flags, 'is_local') AS is_local,",
        "      get_field(base.flags, 'is_annotated') AS is_annotated,",
        "      get_field(base.flags, 'is_free') AS is_free,",
        "      get_field(base.flags, 'is_assigned') AS is_assigned,",
        "      get_field(base.flags, 'is_namespace') AS is_namespace,",
        '      base.namespace_count AS namespace_count,',
        '      base.namespace_block_ids AS namespace_block_ids',
        '    FROM base',
        "",
    ]),
    'ts_ast_calls_check': "\n".join([
        '    WITH ts AS (',
        '      SELECT file_id, path, start_byte, end_byte',
        '      FROM ts_calls',
        '    ),',
        '    ast_base AS (',
        '      SELECT',
        '        file_id,',
        '        path,',
        '        lineno,',
        '        col_offset,',
        '        end_lineno,',
        '        end_col_offset,',
        '        line_base',
        '      FROM ast_calls',
        '    ),',
        '    ast AS (',
        '      SELECT',
        '        ast_base.file_id AS file_id,',
        '        ast_base.path AS path,',
        '        (start_idx.line_start_byte + CAST(ast_base.col_offset AS BIGINT)) AS',
        'start_byte,',
        '        (end_idx.line_start_byte + CAST(ast_base.end_col_offset AS BIGINT))',
        'AS end_byte',
        '      FROM ast_base',
        '      LEFT JOIN file_line_index_v1 AS start_idx',
        '        ON ast_base.file_id = start_idx.file_id',
        '        AND ast_base.path = start_idx.path',
        '        AND (ast_base.lineno - ast_base.line_base) = start_idx.line_no',
        '      LEFT JOIN file_line_index_v1 AS end_idx',
        '        ON ast_base.file_id = end_idx.file_id',
        '        AND ast_base.path = end_idx.path',
        '        AND (ast_base.end_lineno - ast_base.line_base) = end_idx.line_no',
        '    ),',
        '    joined AS (',
        '      SELECT',
        '        COALESCE(ts.file_id, ast.file_id) AS file_id,',
        '        COALESCE(ts.path, ast.path) AS path,',
        '        ts.start_byte AS ts_start_byte,',
        '        ts.end_byte AS ts_end_byte,',
        '        ast.start_byte AS ast_start_byte,',
        '        ast.end_byte AS ast_end_byte',
        '      FROM ts',
        '      FULL OUTER JOIN ast',
        '        ON ts.file_id = ast.file_id',
        '        AND ts.path = ast.path',
        '        AND ts.start_byte = ast.start_byte',
        '        AND ts.end_byte = ast.end_byte',
        '    )',
        '    SELECT',
        '      file_id,',
        '      path,',
        '      SUM(CASE WHEN ts_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS',
        'ts_calls,',
        '      SUM(CASE WHEN ast_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS',
        'ast_calls,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      ) AS ts_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS ast_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      )',
        '      + SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS mismatch_count,',
        '      (',
        '        SUM(',
        '          CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '        + SUM(',
        '          CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '      ) > 0 AS mismatch',
        '    FROM joined',
        '    GROUP BY file_id, path',
        "",
    ]),
    'ts_ast_defs_check': "\n".join([
        '    WITH ts AS (',
        '      SELECT file_id, path, start_byte, end_byte',
        '      FROM ts_defs',
        '    ),',
        '    ast_base AS (',
        '      SELECT',
        '        file_id,',
        '        path,',
        '        lineno,',
        '        col_offset,',
        '        end_lineno,',
        '        end_col_offset,',
        '        line_base',
        '      FROM ast_defs',
        '    ),',
        '    ast AS (',
        '      SELECT',
        '        ast_base.file_id AS file_id,',
        '        ast_base.path AS path,',
        '        (start_idx.line_start_byte + CAST(ast_base.col_offset AS BIGINT)) AS',
        'start_byte,',
        '        (end_idx.line_start_byte + CAST(ast_base.end_col_offset AS BIGINT))',
        'AS end_byte',
        '      FROM ast_base',
        '      LEFT JOIN file_line_index_v1 AS start_idx',
        '        ON ast_base.file_id = start_idx.file_id',
        '        AND ast_base.path = start_idx.path',
        '        AND (ast_base.lineno - ast_base.line_base) = start_idx.line_no',
        '      LEFT JOIN file_line_index_v1 AS end_idx',
        '        ON ast_base.file_id = end_idx.file_id',
        '        AND ast_base.path = end_idx.path',
        '        AND (ast_base.end_lineno - ast_base.line_base) = end_idx.line_no',
        '    ),',
        '    joined AS (',
        '      SELECT',
        '        COALESCE(ts.file_id, ast.file_id) AS file_id,',
        '        COALESCE(ts.path, ast.path) AS path,',
        '        ts.start_byte AS ts_start_byte,',
        '        ts.end_byte AS ts_end_byte,',
        '        ast.start_byte AS ast_start_byte,',
        '        ast.end_byte AS ast_end_byte',
        '      FROM ts',
        '      FULL OUTER JOIN ast',
        '        ON ts.file_id = ast.file_id',
        '        AND ts.path = ast.path',
        '        AND ts.start_byte = ast.start_byte',
        '        AND ts.end_byte = ast.end_byte',
        '    )',
        '    SELECT',
        '      file_id,',
        '      path,',
        '      SUM(CASE WHEN ts_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS ts_defs,',
        '      SUM(CASE WHEN ast_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS',
        'ast_defs,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      ) AS ts_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS ast_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      )',
        '      + SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS mismatch_count,',
        '      (',
        '        SUM(',
        '          CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '        + SUM(',
        '          CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '      ) > 0 AS mismatch',
        '    FROM joined',
        '    GROUP BY file_id, path',
        "",
    ]),
    'ts_ast_imports_check': "\n".join([
        '    WITH ts AS (',
        '      SELECT file_id, path, start_byte, end_byte',
        '      FROM ts_imports',
        '    ),',
        '    ast_base AS (',
        '      SELECT',
        '        file_id,',
        '        path,',
        '        lineno,',
        '        col_offset,',
        '        end_lineno,',
        '        end_col_offset,',
        '        line_base',
        '      FROM ast_imports',
        '    ),',
        '    ast AS (',
        '      SELECT',
        '        ast_base.file_id AS file_id,',
        '        ast_base.path AS path,',
        '        (start_idx.line_start_byte + CAST(ast_base.col_offset AS BIGINT)) AS',
        'start_byte,',
        '        (end_idx.line_start_byte + CAST(ast_base.end_col_offset AS BIGINT))',
        'AS end_byte',
        '      FROM ast_base',
        '      LEFT JOIN file_line_index_v1 AS start_idx',
        '        ON ast_base.file_id = start_idx.file_id',
        '        AND ast_base.path = start_idx.path',
        '        AND (ast_base.lineno - ast_base.line_base) = start_idx.line_no',
        '      LEFT JOIN file_line_index_v1 AS end_idx',
        '        ON ast_base.file_id = end_idx.file_id',
        '        AND ast_base.path = end_idx.path',
        '        AND (ast_base.end_lineno - ast_base.line_base) = end_idx.line_no',
        '    ),',
        '    joined AS (',
        '      SELECT',
        '        COALESCE(ts.file_id, ast.file_id) AS file_id,',
        '        COALESCE(ts.path, ast.path) AS path,',
        '        ts.start_byte AS ts_start_byte,',
        '        ts.end_byte AS ts_end_byte,',
        '        ast.start_byte AS ast_start_byte,',
        '        ast.end_byte AS ast_end_byte',
        '      FROM ts',
        '      FULL OUTER JOIN ast',
        '        ON ts.file_id = ast.file_id',
        '        AND ts.path = ast.path',
        '        AND ts.start_byte = ast.start_byte',
        '        AND ts.end_byte = ast.end_byte',
        '    )',
        '    SELECT',
        '      file_id,',
        '      path,',
        '      SUM(CASE WHEN ts_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS',
        'ts_imports,',
        '      SUM(CASE WHEN ast_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS',
        'ast_imports,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      ) AS ts_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS ast_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      )',
        '      + SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS mismatch_count,',
        '      (',
        '        SUM(',
        '          CASE WHEN ts_start_byte IS NOT NULL AND ast_start_byte IS NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '        + SUM(',
        '          CASE WHEN ts_start_byte IS NULL AND ast_start_byte IS NOT NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '      ) > 0 AS mismatch',
        '    FROM joined',
        '    GROUP BY file_id, path',
        "",
    ]),
    'ts_calls': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'node_id') AS node_id,",
        "      get_field(n0.n0_item, 'parent_id') AS parent_id,",
        "      get_field(n0.n0_item, 'callee_kind') AS callee_kind,",
        "      get_field(n0.n0_item, 'callee_text') AS callee_text,",
        "      get_field(n0.n0_item, 'callee_node_id') AS callee_node_id,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.calls) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.node_id AS ts_node_id,',
        '      base.parent_id AS parent_ts_id,',
        '      base.callee_kind AS callee_kind,',
        '      base.callee_text AS callee_text,',
        '      base.callee_node_id AS callee_node_id,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_captures': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'capture_id') AS capture_id,",
        "      get_field(n0.n0_item, 'query_name') AS query_name,",
        "      get_field(n0.n0_item, 'capture_name') AS capture_name,",
        "      get_field(n0.n0_item, 'pattern_index') AS pattern_index,",
        "      get_field(n0.n0_item, 'node_id') AS node_id,",
        "      get_field(n0.n0_item, 'node_kind') AS node_kind,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.captures) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.capture_id AS ts_capture_id,',
        '      base.query_name AS query_name,',
        '      base.capture_name AS capture_name,',
        '      base.pattern_index AS pattern_index,',
        '      base.node_id AS ts_node_id,',
        '      base.node_kind AS node_kind,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_cst_docstrings_check': "\n".join([
        '    WITH ts AS (',
        '      SELECT file_id, path, start_byte, end_byte',
        '      FROM ts_docstrings',
        '    ),',
        '    cst AS (',
        '      SELECT',
        '        file_id,',
        '        path,',
        '        CAST(bstart AS BIGINT) AS start_byte,',
        '        CAST(bend AS BIGINT) AS end_byte',
        '      FROM cst_docstrings',
        '    ),',
        '    joined AS (',
        '      SELECT',
        '        COALESCE(ts.file_id, cst.file_id) AS file_id,',
        '        COALESCE(ts.path, cst.path) AS path,',
        '        ts.start_byte AS ts_start_byte,',
        '        ts.end_byte AS ts_end_byte,',
        '        cst.start_byte AS cst_start_byte,',
        '        cst.end_byte AS cst_end_byte',
        '      FROM ts',
        '      FULL OUTER JOIN cst',
        '        ON ts.file_id = cst.file_id',
        '        AND ts.path = cst.path',
        '        AND ts.start_byte = cst.start_byte',
        '        AND ts.end_byte = cst.end_byte',
        '    )',
        '    SELECT',
        '      file_id,',
        '      path,',
        '      SUM(CASE WHEN ts_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS',
        'ts_docstrings,',
        '      SUM(CASE WHEN cst_start_byte IS NOT NULL THEN 1 ELSE 0 END) AS',
        'cst_docstrings,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND cst_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      ) AS ts_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND cst_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS cst_only,',
        '      SUM(',
        '        CASE WHEN ts_start_byte IS NOT NULL AND cst_start_byte IS NULL THEN',
        '1 ELSE 0 END',
        '      )',
        '      + SUM(',
        '        CASE WHEN ts_start_byte IS NULL AND cst_start_byte IS NOT NULL THEN',
        '1 ELSE 0 END',
        '      ) AS mismatch_count,',
        '      (',
        '        SUM(',
        '          CASE WHEN ts_start_byte IS NOT NULL AND cst_start_byte IS NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '        + SUM(',
        '          CASE WHEN ts_start_byte IS NULL AND cst_start_byte IS NOT NULL',
        'THEN 1 ELSE 0 END',
        '        )',
        '      ) > 0 AS mismatch',
        '    FROM joined',
        '    GROUP BY file_id, path',
        "",
    ]),
    'ts_defs': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'node_id') AS node_id,",
        "      get_field(n0.n0_item, 'parent_id') AS parent_id,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.defs) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.node_id AS ts_node_id,',
        '      base.parent_id AS parent_ts_id,',
        '      base.kind AS kind,',
        '      base.name AS name,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_docstrings': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'owner_node_id') AS owner_node_id,",
        "      get_field(n0.n0_item, 'owner_kind') AS owner_kind,",
        "      get_field(n0.n0_item, 'owner_name') AS owner_name,",
        "      get_field(n0.n0_item, 'doc_node_id') AS doc_node_id,",
        "      get_field(n0.n0_item, 'docstring') AS docstring,",
        "      get_field(n0.n0_item, 'source') AS source,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.docstrings) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.owner_node_id AS owner_node_id,',
        '      base.owner_kind AS owner_kind,',
        '      base.owner_name AS owner_name,',
        '      base.doc_node_id AS doc_node_id,',
        '      base.docstring AS docstring,',
        '      base.source AS source,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_edges': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'parent_id') AS parent_id,",
        "      get_field(n0.n0_item, 'child_id') AS child_id,",
        "      get_field(n0.n0_item, 'field_name') AS field_name,",
        "      get_field(n0.n0_item, 'child_index') AS child_index,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.edges) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.parent_id AS parent_ts_id,',
        '      base.child_id AS child_ts_id,',
        '      base.field_name AS field_name,',
        '      base.child_index AS child_index,',
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_errors': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'error_id') AS error_id,",
        "      get_field(n0.n0_item, 'node_id') AS node_id,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.errors) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.error_id AS ts_error_id,',
        '      base.node_id AS ts_node_id,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        '      CAST(TRUE AS BOOLEAN) AS is_error,',
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_imports': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'node_id') AS node_id,",
        "      get_field(n0.n0_item, 'parent_id') AS parent_id,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'module') AS module,",
        "      get_field(n0.n0_item, 'name') AS name,",
        "      get_field(n0.n0_item, 'asname') AS asname,",
        "      get_field(n0.n0_item, 'alias_index') AS alias_index,",
        "      get_field(n0.n0_item, 'level') AS level,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.imports) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.node_id AS ts_node_id,',
        '      base.parent_id AS parent_ts_id,',
        '      base.kind AS kind,',
        '      base.module AS module,',
        '      base.name AS name,',
        '      base.asname AS asname,',
        '      base.alias_index AS alias_index,',
        '      base.level AS level,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_missing': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'missing_id') AS missing_id,",
        "      get_field(n0.n0_item, 'node_id') AS node_id,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.missing) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.missing_id AS ts_missing_id,',
        '      base.node_id AS ts_node_id,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        '      CAST(TRUE AS BOOLEAN) AS is_missing,',
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_nodes': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(n0.n0_item, 'node_id') AS node_id,",
        "      get_field(n0.n0_item, 'node_uid') AS node_uid,",
        "      get_field(n0.n0_item, 'parent_id') AS parent_id,",
        "      get_field(n0.n0_item, 'kind') AS kind,",
        "      get_field(n0.n0_item, 'kind_id') AS kind_id,",
        "      get_field(n0.n0_item, 'grammar_id') AS grammar_id,",
        "      get_field(n0.n0_item, 'grammar_name') AS grammar_name,",
        "      get_field(n0.n0_item, 'span') AS span,",
        "      get_field(n0.n0_item, 'flags') AS flags,",
        "      get_field(n0.n0_item, 'attrs') AS attrs",
        'FROM tree_sitter_files_v1 AS root',
        'CROSS JOIN unnest(root.nodes) AS n0(n0_item))',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.node_id AS ts_node_id,',
        '      base.node_uid AS ts_node_uid,',
        '      base.parent_id AS parent_ts_id,',
        '      base.kind AS ts_type,',
        '      base.kind_id AS ts_kind_id,',
        '      base.grammar_id AS ts_grammar_id,',
        '      base.grammar_name AS ts_grammar_name,',
        "      get_field(get_field(base.span, 'start'), 'line0') AS start_line,",
        "      get_field(get_field(base.span, 'start'), 'col') AS start_col,",
        "      get_field(get_field(base.span, 'end'), 'line0') AS end_line,",
        "      get_field(get_field(base.span, 'end'), 'col') AS end_col,",
        '      CAST(0 AS INT) AS line_base,',
        "      get_field(base.span, 'col_unit') AS col_unit,",
        "      get_field(base.span, 'end_exclusive') AS end_exclusive,",
        "      get_field(get_field(base.span, 'byte_span'), 'byte_start') AS",
        'start_byte,',
        "      (get_field(get_field(base.span, 'byte_span'), 'byte_start') +",
        "get_field(get_field(base.span, 'byte_span'), 'byte_len')) AS end_byte,",
        "      get_field(base.flags, 'is_named') AS is_named,",
        "      get_field(base.flags, 'has_error') AS has_error,",
        "      get_field(base.flags, 'is_error') AS is_error,",
        "      get_field(base.flags, 'is_missing') AS is_missing,",
        "      get_field(base.flags, 'is_extra') AS is_extra,",
        "      get_field(base.flags, 'has_changes') AS has_changes,",
        "      arrow_cast(base.attrs, 'Map(Utf8, Utf8)') AS attrs",
        '    FROM base',
        "",
    ]),
    'ts_span_metadata': "\n".join([
        '    SELECT',
        "      arrow_metadata(nodes.span, 'line_base') AS nodes_line_base,",
        "      arrow_metadata(nodes.span, 'col_unit') AS nodes_col_unit,",
        "      arrow_metadata(nodes.span, 'end_exclusive') AS nodes_end_exclusive,",
        "      arrow_metadata(errors.span, 'line_base') AS errors_line_base,",
        "      arrow_metadata(errors.span, 'col_unit') AS errors_col_unit,",
        "      arrow_metadata(errors.span, 'end_exclusive') AS errors_end_exclusive,",
        "      arrow_metadata(missing.span, 'line_base') AS missing_line_base,",
        "      arrow_metadata(missing.span, 'col_unit') AS missing_col_unit,",
        "      arrow_metadata(missing.span, 'end_exclusive') AS",
        'missing_end_exclusive,',
        "      arrow_metadata(captures.span, 'line_base') AS captures_line_base,",
        "      arrow_metadata(captures.span, 'col_unit') AS captures_col_unit,",
        "      arrow_metadata(captures.span, 'end_exclusive') AS",
        'captures_end_exclusive,',
        "      arrow_metadata(defs.span, 'line_base') AS defs_line_base,",
        "      arrow_metadata(defs.span, 'col_unit') AS defs_col_unit,",
        "      arrow_metadata(defs.span, 'end_exclusive') AS defs_end_exclusive,",
        "      arrow_metadata(calls.span, 'line_base') AS calls_line_base,",
        "      arrow_metadata(calls.span, 'col_unit') AS calls_col_unit,",
        "      arrow_metadata(calls.span, 'end_exclusive') AS calls_end_exclusive,",
        "      arrow_metadata(imports.span, 'line_base') AS imports_line_base,",
        "      arrow_metadata(imports.span, 'col_unit') AS imports_col_unit,",
        "      arrow_metadata(imports.span, 'end_exclusive') AS",
        'imports_end_exclusive,',
        "      arrow_metadata(docstrings.span, 'line_base') AS docstrings_line_base,",
        "      arrow_metadata(docstrings.span, 'col_unit') AS docstrings_col_unit,",
        "      arrow_metadata(docstrings.span, 'end_exclusive') AS",
        'docstrings_end_exclusive',
        '    FROM tree_sitter_files_v1',
        '    LIMIT 1',
        "",
    ]),
    'ts_stats': "\n".join([
        '    WITH base AS (SELECT',
        '      root.file_id AS file_id,',
        '      root.path AS path,',
        "      get_field(root.stats, 'node_count') AS node_count,",
        "      get_field(root.stats, 'named_count') AS named_count,",
        "      get_field(root.stats, 'error_count') AS error_count,",
        "      get_field(root.stats, 'missing_count') AS missing_count,",
        "      get_field(root.stats, 'parse_ms') AS parse_ms,",
        "      get_field(root.stats, 'parse_timed_out') AS parse_timed_out,",
        "      get_field(root.stats, 'incremental_used') AS incremental_used,",
        "      get_field(root.stats, 'query_match_count') AS query_match_count,",
        "      get_field(root.stats, 'query_capture_count') AS query_capture_count,",
        "      get_field(root.stats, 'match_limit_exceeded') AS match_limit_exceeded",
        'FROM tree_sitter_files_v1 AS root)',
        '    SELECT',
        '      base.file_id AS file_id,',
        '      base.path AS path,',
        '      base.node_count AS node_count,',
        '      base.named_count AS named_count,',
        '      base.error_count AS error_count,',
        '      base.missing_count AS missing_count,',
        '      base.parse_ms AS parse_ms,',
        '      base.parse_timed_out AS parse_timed_out,',
        '      base.incremental_used AS incremental_used,',
        '      base.query_match_count AS query_match_count,',
        '      base.query_capture_count AS query_capture_count,',
        '      base.match_limit_exceeded AS match_limit_exceeded',
        '    FROM base',
        "",
    ]),
}

__all__ = ["FRAGMENT_SQL"]
